<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Chapter&nbsp;3.&nbsp;Admin Tools</title>
      <link rel="stylesheet" href="../css/bigworld.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="index.html" title="Server Operations Guide">
      <link rel="up" href="index.html" title="Server Operations Guide">
      <link rel="prev" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Server Configuration with bw.xml">
      <link rel="next" href="ch04.html" title="Chapter&nbsp;4.&nbsp;Watcher (Web Interface)"><script type="text/javascript" src="../css/bigworld.js"></script></head>
   <body onLoad="loader();">
      <div id="bigworld-header"><img src="bigworld_logo.gif" id="bwLogo" alt="bw logo"></div>
      <div id="content">
         <div class="navheader">
            <table width="95%" align="center" summary="Navigation header">
               <tr>
                  <th colspan="3" align="center">Chapter&nbsp;3.&nbsp;Admin Tools</th>
               </tr>
               <tr>
                  <td width="20%" align="left"><a accesskey="p" href="ch02.html">Prev</a>&nbsp;
                  </td>
                  <th width="55%" align="center">&nbsp;</th>
                  <td width="20%" align="right">&nbsp;<a accesskey="n" href="ch04.html">Next</a></td>
               </tr>
            </table>
            <hr class="navheaderline">
         </div>
         <div class="chapter" lang="en">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="xref_Admin_Tools"></a>Chapter&nbsp;3.&nbsp;Admin Tools
                     </h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Table of Contents</b></p>
               <dl>
                  <dt><span class="sect1"><a href="ch03.html#xref_WebConsole">3.1. WebConsole</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sect2"><a href="ch03.html#d0e4817">3.1.1. Modules</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#d0e4906">3.1.2. Configuration</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#d0e4993">3.1.3. How to Start</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="sect1"><a href="ch03.html#xref_Logger_Daemons">3.2. Logger Daemons</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sect2"><a href="ch03.html#xref_MessageLogger">3.2.1. MessageLogger</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#xref_StatLogger">3.2.2. StatLogger</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="sect1"><a href="ch03.html#xref_Server_Command_Line_Utilities">3.3. Server Command-Line Utilities</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sect2"><a href="ch03.html#xref_control_cluster_py">3.3.1. <span class="literal">control_cluster.py</span></a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#d0e7090">3.3.2. <span class="literal">eload</span> (Entity Loader)</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#d0e7134">3.3.3. MessageLogger Related Utilities</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#d0e7141">3.3.4. <span class="literal">mls</span> (Machine List)</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#xref_runscript">3.3.5. <span class="literal">runscript</span></a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="sect1"><a href="ch03.html#xref_Standard_GUI_Applications">3.4. Standard GUI Applications</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="sect2"><a href="ch03.html#xref_BWPanel">3.4.1. BWPanel</a></span></dt>
                        <dt><span class="sect2"><a href="ch03.html#xref_Space_Viewer">3.4.2. Space Viewer</a></span></dt>
                     </dl>
                  </dd>
               </dl>
            </div>
            <p>A variety of tools are provided to assist in managing the BigWorld
                 server. Broadly, these fall into four categories:
            </p>
            <div class="itemizedlist">
               <ul type="disc">
                  <li>
                     <p><em class="emphasis">WebConsole</em> (See <a href="ch03.html#xref_WebConsole" title="3.1.&nbsp;WebConsole">WebConsole</a>.)
                     </p>
                  </li>
                  <li>
                     <p><em class="emphasis">Logger daemons</em> (See <a href="ch03.html#xref_Logger_Daemons" title="3.2.&nbsp;Logger Daemons">Logger Daemons</a>.)
                     </p>
                  </li>
                  <li>
                     <p><em class="emphasis">Server command-line utilities (e.g.,
                                 <span class="literal">control_cluster.py</span>) </em> (See <a href="ch03.html#xref_Server_Command_Line_Utilities" title="3.3.&nbsp;Server Command-Line Utilities">Server Command-Line Utilities</a>.)
                     </p>
                  </li>
                  <li>
                     <p><em class="emphasis">Standard GUI applications (e.g., SpaceViewer
                                 and BWPanel)</em> (See <a href="ch03.html#xref_Standard_GUI_Applications" title="3.4.&nbsp;Standard GUI Applications">Standard GUI Applications</a>.)
                     </p>
                  </li>
               </ul>
            </div>
            <p>The server tools are implemented almost entirely in Python, and can be
                 easily extended by any customer, if additional functionality is
                 desired.
            </p>
            <p>BigWorld 1.8 moved most of the server tools functionality into the new
                 WebConsole, in order to improve and unify the server toolset and simplify
                 server administration for remote users and non-programmers
                 (<em class="emphasis">e.g.</em>, artists, game designers, etc.) that may need to
                 run and administer servers. Functionality formerly provided by tools such as
                 ServerViewer, GMeter, watcher, and bw_log_viewer.cgi has been consolidated
                 under WebConsole's single easy-to-use web interface.
            </p>
            <p>Almost all server tool functionality is still available via
                 command-line utilities, which is useful when only system console access is
                 available (<em class="emphasis">e.g.</em>, when remotely administering a server
                 cluster via ssh).
            </p>
            <p>Where possible, documentation for the server tools is maintained as
                 online help. For WebConsole, this means the Help link displayed in the
                 navigation menu for each module. For command-line utilities, help is
                 available via the --help switch.
            </p>
            <p>This chapter provides an overview of the suite of tools available. For
                 detailed documentation, however, please refer to the online help.
            </p>
            <div class="sect1" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="xref_WebConsole"></a>3.1.&nbsp;WebConsole
                        </h2>
                     </div>
                  </div>
               </div>
               <p>Located under <span class="literal">bigworld/tools/server/web_console</span>
                      folder, WebConsole provides a simple web interface to manage and monitor a
                      BigWorld server. For details on how to install and run WebConsole, see the
                      document <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Server Tools
                         Installation Guide</span>.
               </p>
               <p>Complete documentation for each WebConsole module is provided as
                      online help, accessible as a link on the left hand side of the WebConsole
                      page.
               </p>
               <p>WebConsole consolidates functionality that was provided by a number
                      of discrete tools BigWorld releases prior to 1.8, and is composed of the
                      modules described below.
               </p>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e4817"></a>3.1.1.&nbsp;Modules
                           </h3>
                        </div>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_ClusterControl"></a>3.1.1.1.&nbsp;ClusterControl
                              </h4>
                           </div>
                        </div>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>Allows users to start, stop, and restart the game
                                             server.
                              </p>
                           </li>
                           <li>
                              <p>Can browse the active machines and users on the local
                                             network.
                              </p>
                           </li>
                           <li>
                              <p>Can inspect the watcher tree of any running process.</p>
                           </li>
                           <li>
                              <p>Can establish a connection to a BigWorld process's Python
                                             server.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="informalfigure">
                        <div class="mediaobject">
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="480">
                              <tr>
                                 <td><img src="images/clustercontrol_module.png" width="480"></td>
                              </tr>
                           </table><span class="caption">
                              <p>ClusterControl module</p></span></div>
                     </div>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Note</h3>
                        <p>This module replaces Server Viewer, Watcher, and some parts of
                                     BWPanel.
                        </p>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e4846"></a>3.1.1.2.&nbsp;LogViewer
                              </h4>
                           </div>
                        </div>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>Allows users to view, filter, and search server message
                                             logs.
                              </p>
                           </li>
                           <li>
                              <p>Provides a live view of server output, similar to calling
                                             <span class="literal">tail -f</span> on a logfile.
                              </p>
                           </li>
                           <li>
                              <p>Provides summaries of per-user log usage.</p>
                           </li>
                        </ul>
                     </div>
                     <div class="informalfigure">
                        <div class="mediaobject">
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="480">
                              <tr>
                                 <td><img src="images/logviewer_module.png" width="480"></td>
                              </tr>
                           </table><span class="caption">
                              <p>LogViewer module</p></span></div>
                     </div>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Note</h3>
                        <p>This module replaces bw_log_viewer.cgi.</p>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_StatGrapher"></a>3.1.1.3.&nbsp;StatGrapher
                              </h4>
                           </div>
                        </div>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>Provides live and historic graphic views of server
                                             statistics.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="informalfigure">
                        <div class="mediaobject">
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="480">
                              <tr>
                                 <td><img src="images/statgrapher_module.png" width="480"></td>
                              </tr>
                           </table><span class="caption">
                              <p>StatGrapher module</p></span></div>
                     </div>
                     <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <h3 class="title">Note</h3>
                        <p>This module replaces GMeter.</p>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e4889"></a>3.1.1.4.&nbsp;Python Console
                              </h4>
                           </div>
                        </div>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>Allows users to connect to the Python server of any process
                                             that has one (<em class="emphasis">i.e.</em>, CellApp, BaseApp,
                                             Bots).
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="informalfigure">
                        <div class="mediaobject">
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="480">
                              <tr>
                                 <td><img src="images/python_console_module.png" width="480"></td>
                              </tr>
                           </table><span class="caption">
                              <p>Python Console module</p></span></div>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e4906"></a>3.1.2.&nbsp;Configuration
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>When the server tools are installed using the
                           <span class="literal">install_tools.py</span> script (for details, see the
                           document <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Server Tools
                              Installation Guide</span>), a system-wide configuration file
                           (<span class="literal">/etc/bigworld.conf</span>) is used to locate tool
                           components/tool configuration files and environment settings needed to
                           run the server tools.
                  </p>
                  <p>The primary user of this configuration file is the system
                           startup/shutdown scripts installed into /etc/init.d. However, server
                           tools such as MessageLogger may use this file to locate a working
                           environment, if no appropriate command-line options are provided.
                  </p>
                  <p>The format of the configuration file is in a Windows INI style
                           format &#8212; comments may be provided by preceding them with the
                           <span class="literal">#</span> (pound sign) or <span class="literal">;</span> (semicolon)
                           characters.
                  </p>
                  <p>The keywords in the <span class="literal">/etc/bigworld.conf</span> are
                           described in the list below:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p><em class="emphasis"><span class="literal">username</span></em></p>
                           <p>Username that maps to a valid system account. All server tool
                                        daemon processes will be run as this user.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">groupname</span></em></p>
                           <p>Group that should own all server tools.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">piddi</span>r</em></p>
                           <p>Folder on which server tools running in daemon mode should
                                        write their .pid files with their process ID. This file is used to
                                        later identify whether that daemon process is running, and if so,
                                        what system process it is. Most system daemons write their .pid
                                        files to /var/run or one of its sub-folders. The default folder for
                                        the BigWorld server tools <span class="literal">.pid</span> files is
                                        <span class="literal">/var/run/bigworld</span>.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">location</span></em></p>
                           <p>Base folder of the server tools. Used by the system
                                        initialisation scripts, in order to be able to launch the server
                                        tools. Within a normal BigWorld package/checkout, this would refer
                                        to
                                        <span class="literal"><em class="replaceable"><code>[prefix]</code></em>/mf/bigworld/tools/server</span>.
                                        For a server installation, it is recommended that this folder is
                                        located within the home directory of the user username.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p>Below is an example <span class="literal">/etc/bigworld.conf</span>
                           configuration file:
                  </p><pre class="programlisting">[tools]
username = bwtools
piddir = /var/run/bigworld
location = /home/bwtools/mf/bigworld/tools/server
groupname = bwtools</pre><p><span class="citetitle">Example
                              <span class="literal">/etc/bigworld/conf</span></span></p>
                  <p>A sample configuration file can also be found in
                           <span class="literal">bigworld/tools/server/install/ bigworld.conf</span>.
                  </p>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e4993"></a>3.1.3.&nbsp;How to Start
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>WebConsole can be started using two methods:</p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p>As a system daemon &#8212; for details, see the document <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Server Tools
                                           Installation Guide</span>'s section <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Post-Installation</span>.
                           </p>
                        </li>
                        <li>
                           <p>From the command line.</p>
                        </li>
                     </ul>
                  </div>
                  <p>Generally, only developers working on modifying the web page
                           templates or underlying code will run WebConsole in this fashion.
                  </p>
                  <p>Make sure that the current folder is
                           <span class="literal">bigworld/tools/server/web_console</span>, then issue the
                           command:
                  </p><pre class="programlisting">./start-web_console.py</pre><p>There are some minor operational differences when running
                           WebConsole in the two mentioned modes:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p>When run as a system daemon, WebConsole uses the configuration
                                        file <span class="literal">prod.cfg</span>, which defines a production
                                        environment mode.
                           </p>
                        </li>
                        <li>
                           <p>When run from the command line, WebConsole uses a development
                                        environment configuration file called
                                        <span class="literal">dev.cfg</span>.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p>Running in development mode leaves the web server in a state where
                           an automatic restart is triggered if there are any changes to the
                           template files or Python code it is using.
                  </p>
                  <p>The production configuration file does not exist by default in
                           <span class="literal">bigworld/tools/server/ web_console</span>, as it is
                           partially generated during the installation process while using the
                           <span class="literal">install_tools.py</span> script. The original production
                           configuration file that the installation script uses is
                           <span class="literal">bigworld/tools/server/install/web_console.cfg</span>.
                  </p>
                  <p>Both configuration files need to specify the database to use.
                           Before running WebConsole, make sure that the appropriate configuration
                           file has a line that looks like this:
                  </p><pre class="programlisting">sqlobject.dburi="notrans_mysql://username:password@localhost:3306/bw_web_console"</pre><p><span class="citetitle">Specifying the database</span></p>
                  <p>To modify the
                           <span class="literal">bigworld/tools/server/install/web_console.cfg</span> file to
                           a working configuration file, replace the line:
                  </p><pre class="programlisting">###BW_SQLURI###</pre><p>with an <span class="literal">sqlobject.dburi</span> line as indicated
                           above.
                  </p>
                  <p>For information regarding TurboGears configuration files and
                           content, we recommend the TurboGears documentation website
                           http://docs.turbogears.org/1.0/Configuration.
                  </p>
                  <p>If you have never run WebConsole before and choose to run it from
                           the command line (as opposed to installing the system service), it is
                           necessary to create a database for WebConsole within MySQL. To do this,
                           connect to your MySQL database using the username and password that you
                           have defined in <span class="literal">dev.cfg</span>, then issue the following
                           command:
                  </p><pre class="programlisting">CREATE DATABASE bw_web_console;</pre></div>
            </div>
            <div class="sect1" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="xref_Logger_Daemons"></a>3.2.&nbsp;Logger Daemons
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_MessageLogger"></a>3.2.1.&nbsp;MessageLogger
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>MessageLogger replaces bwlogger as the server output logger &#8212; its
                           source code is located in
                           <span class="literal">bigworld/src/server/tools/message_logger</span>, while its
                           executable and related Python tools and libraries are located in
                           <span class="literal">bigworld/tools/server/message_logger</span>.
                  </p>
                  <p>Detailed documentation for the supported command-line switches is
                           available as online help, and can be viewed via the
                           <span class="literal">--help</span> switch. This document provides an overview of
                           how MessageLogger works, and the structure of the files it
                           generates.
                  </p>
                  <p>When a server process (<em class="emphasis">e.g.</em>, a CellApp) is
                           started, it searches the cluster for all active MessageLogger processes,
                           and proceeds to route to each discovered MessageLogger process all
                           output generated by script calls to print, or calls to
                           <span class="literal">INFO_MSG</span>, <span class="literal">ERROR_MSG</span>, etc....
                           MessageLogger processes that are started after a server process will
                           notify all running server components of their existence, in order to
                     	  start immediate logging.
                  </p>
                  <p>The BigWorld Client can also be configured to send messages to
                           the message logger. By default this is enabled in the Hybrid build and
                           disabled in the Release build. The Consumer build has this controlled
                     	  by a set of defines in <span class="literal">src/lib/cstdmf/config.hpp</span>.
                           
                  </p>
                  <p>The following defines should be enabled in Consumer to enable
                     	  the client to send messages to the message logger:
                  </p><pre class="programlisting">
      #define FORCE_ENABLE_MSG_LOGGING     1
      #define FORCE_ENABLE_DPRINTF         1
      #define FORCE_ENABLE_WATCHERS        1
	  </pre><p>Messages from the client are by default sent to the
                     	  <span class="literal">root</span> user. To send to a different user, set a
                     	  UID environment variable for the user running client. The UID
                           should be set to the numerical value of the user's Linux UID.
                  </p>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5120"></a>3.2.1.1.&nbsp;Configuration
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Except where overridden by corresponding command-line options,
                                MessageLogger reads its configuration from the file
                                <span class="literal">message_logger.conf</span>, located in the same folder as
                                the executable itself. An alternate configuration file can be
                                specified on the command-line with the <span class="literal">-c/--config</span>
                                switch.
                     </p>
                     <p>The configuration file is in standard Windows INI file format,
                                and supports the options:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">logdir</span></em></p>
                              <p>The location of the top-level folder to which MessageLogger
                                             will write its logs. This option can be either a relative or an
                                             absolute path. If a relative path is specified, then it is
                                             calculated relative to the location of the configuration file &#8212;
                                             not relative to the folder current at the time of
                                             execution.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">segment_size</span></em></p>
                              <p>Size (in bytes) at which the logger will automatically roll
                                             the current log segment for a particular user.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">default_archive</span></em></p>
                              <p>File used by mltar.py when the
                                             <span class="literal">-d/--default_archive</span> switch is used. This file
                                             is also inserted into MessageLogger's logrotate script by
                                             <span class="literal">install_tools.py</span>.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5161"></a>3.2.1.2.&nbsp;File Format
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>MessageLogger generates files in binary format, but it supports
                                the generation of text files (in the BigWorld 1.7 format) via the
                                <span class="literal">--text</span> option. This option generates text files in
                                addition to the binary files, in case you have tools that depend on
                                the old logfile format.
                     </p>
                     <p>Included in MessageLogger, along with the message_logger binary
                                itself, are Python modules that provide an interface to this binary
                                format:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">bwlog.so</span></em>
                                             &#8212; A Python extension, compiled from MessageLogger source
                                             code
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">message_log.py</span></em> &#8212;
                                             Provides pure Python classes that simplify and extend the
                                             functionality exposed in <span class="literal">bwlog.so</span>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>For examples on how to use these modules, browse the source code
                                of the command-line message logger utilities
                                (<span class="literal">mlcat.py</span>, <span class="literal">mlls.py</span>, etc...)
                                described in <a href="ch03.html#xref_Command_Line_Utilities" title="3.2.1.3.&nbsp;Command-Line Utilities">Command-Line Utilities</a>.
                     </p>
                     <p>MessageLogger generates logs in a two-level folder structure &#8212;
                                the top-level folder contains files that are common to all users, as
                                well as one sub-folder per user. The files in the top-level folder
                                are:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">component_names</span></em></p>
                              <p>List of all distinct component names
                                             (<em class="emphasis">i.e.</em>, CellApp, BaseApp, etc...) that have
                                             sent messages to this logger. This is used to resolve numeric
                                             component type IDs to names, when displaying log output.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">hostnames</span></em></p>
                              <p>Mapping from IP addresses to hostnames. This is used for
                                             resolving hostnames when displaying log output.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">strings</span></em></p>
                              <p>List of all unique format strings that have been sent by
                                             server components, along with parser data for interpreting
                                             arguments to each. This is used to reconstruct the log messages
                                             from format string IDs and binary argument blobs.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">version</span></em></p>
                              <p>Log format version. This is used to prevent accidental
                                             mixing two log formats.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">pid</span></em></p>
                              <p>PID of active MessageLogger process. This is used by tools
                                             and MessageLogger to identify the process (if any) currently
                                             generating logs.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>Each user's sub-folder has a file containing its UID, as well as
                                the following files:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">components</span></em></p>
                              <p>A record of each individual process instance registered with
                                             this logger.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">entries.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span>,
                                                <span class="literal">args.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span></em></p>
                              <p>A segment of log messages. The fixed-length portion of each
                                             log message (time, component ID, etc...) is stored in the
                                             <span class="literal">entries.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span>
                                             file, while the variable-length portion of the entry
                                             (<em class="emphasis">i.e.</em>, arguments to printf) is stored in the
                                             corresponding
                                             <span class="literal">args.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span>
                                             file.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">text.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span></em></p>
                              <p>BigWorld 1.7-compatible plain-text record of the log
                                             entries, from the corresponding
                                             <span class="literal">entries.<em class="replaceable"><code>&lt;timestamp&gt;</code></em>/args.<em class="replaceable"><code>&lt;timestamp&gt;</code></em></span>
                                             pair. This file is generated if the <span class="literal">--text</span>
                                             option was specified.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_Command_Line_Utilities"></a>3.2.1.3.&nbsp;Command-Line Utilities
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The <span class="literal">bigworld/tools/server/message_logger</span>
                                folder contains a variety of command-line utilities, providing the
                                functionality of standard UNIX shell utilities for message logs. Using
                                these utilities, you can operate on the binary logs using standard
                                UNIX shell utilities and pipelines, in the same way you could with the
                                old text format logs.
                     </p>
                     <p>The following tools are provided:</p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">mlcat.py</span></em></p>
                              <p>Provides both cat and <span class="literal">tail -f</span> style of
                                             text dumping of the logs.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mlls.py</span></em></p>
                              <p>Displays information about log segments, such as start and
                                             end times, entry counts, and sizes; for individual users or all of
                                             them.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mltar.py</span></em></p>
                              <p>Provides an easy way to select log segments from a user's
                                             log and archive them, as well as all the required shared files for
                                             viewing on another machine.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mlrm.py</span></em></p>
                              <p>Provides an easy way to clean up unwanted log
                                             segments.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>The detailed documentation for each utility is maintained as
                                online help, which can be accessed via the <span class="literal">--help</span>
                                option.
                     </p>
                     <p>The list below provides some common examples of tasks you might
                                wish to achieve using the MessageLogger tools:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">mlcat.py
                                                   -f</span></em></p>
                              <p>Watches live server logs.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mlcat.py --around="Mon 22 Jan
                                                   2007 19:00:00" -u devuser</span></em></p>
                              <p>Views output surrounding a log entry of interest for user
                                             devuser.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mltar.py -zcf
                                                   bwsupport.tar.gz --active-segment</span></em></p>
                              <p>Collects logs to email to support.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mltar.py -u &lt;uid&gt; -zcf
                                                   bwsupport.tar.gz --active-segment</span></em></p>
                              <p>Collects logs for the Unix user whose uid is <span class="literal">uid
                                    			</span>to email to support.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mlls.py -u
                                                   gameuser</span></em></p>
                              <p>Displays all log segments for user gameuser, to determine
                                             the segment with entries of interest.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mlrm.py
                                                   --days=30</span></em></p>
                              <p>Removes logs over a month old.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mltar.py -xf lastweek.tar.gz
                                                   -o samplelogs</span></em></p>
                              <p>Extracts the archive lastweek.tar.bz2 to the folder
                                             samplelogs.
                              </p>
                              <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                                 <h3 class="title">Note</h3>
                                 <p>Since the archives are compressed tar files, you can use
                                                  tar to achieve the same results if you find that easier, as
                                                  illustrated below:
                                 </p><pre class="programlisting">$ mkdir samplelogs
$ tar -zxf lastweek.tar.gz -C samplelogs</pre></div>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">mltar.py
                                                   -xd</span></em></p>
                              <p>Extracts the latest archive back to the default
                                             logdir.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5409"></a>3.2.1.4.&nbsp;Configuration Options
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The MessageLogger command-line options are described in the list
                                below:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-u
                                                   <em class="replaceable"><code>UID</code></em></span></em></p>
                              <p>UID of the user whose processes should be logged. If UID is
                                             all, then messages from all users will be logged. If no UID is
                                             specified, then processes by all users will be logged.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-p
                                                   <em class="replaceable"><code>NAME</code></em></span> (this option is mutually
                                                exclusive to <span class="literal">-d
                                                   <em class="replaceable"><code>NAME</code></em></span>)</em></p>
                              <p>Name of the process which messages should be logged.
                                             Multiple names may be specified, using multiple
                                             <span class="literal">-p</span> options. By default, messages from processes
                                             of any name are logged. Appropriate names include: CellAppMgr,
                                             CellApp, BaseApp, BaseAppMgr, DBMgr, LoginApp, WPGen.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-d
                                                   <em class="replaceable"><code>NAME</code></em></span> (this option is mutually
                                                exclusive to <span class="literal">-p
                                                   <em class="replaceable"><code>NAME</code></em></span>)</em></p>
                              <p>Name of the process which messages should not be logged.
                                             Multiple names may be specified, using multiple
                                             <span class="literal">-d</span> options. By default messages from processes
                                             of any name are logged.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-l
                                                   <em class="replaceable"><code>loggerID</code></em></span></em></p>
                              <p>ID of the processes whose messages should be logged &#8212; value
                                             range is 0-255. The default is 0, a special value that causes
                                             logging all processes, regardless of loggerID.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-v</span></em></p>
                              <p>Prints all messages to standard output (verbose
                                             mode).
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">--daemon</span></em></p>
                              <p>Runs MessageLogger as daemon.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-c|--config
                                                   <em class="replaceable"><code>&lt;file&gt;</code></em></span></em></p>
                              <p>Configuration file to use. The default is
                                             message_logger.conf in the MessageLogger folder. Option overridden
                                             by [outdir] option.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-t|--text</span></em></p>
                              <p>Generates BigWorld 1.7-style text logs, as well as binary
                                             logs.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-q|--quiet</span></em></p>
                              <p>Turns off the display of messages generated by the
                                             MessageLogger process (quiet mode). By default, these are output
                                             to standard error.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-o
                                                   <em class="replaceable"><code>filename</code></em></span></em></p>
                              <p>Redirects standard output to filename.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-e
                                                   <em class="replaceable"><code>filename</code></em></span></em></p>
                              <p>Redirects standard error to filename.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-[TRACE|DEBUG|INFO|NOTICE|WARNING|ERROR|CRITICAL|HACK|SCRIPT]</span></em></p>
                              <p>Disables logging of specific type of message.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">+[TRACE|DEBUG|INFO|NOTICE|WARNING|ERROR|CRITICAL|HACK|SCRIPT]</span></em></p>
                              <p>Enables logging of specific type of message. The first
                                             option of this type disables logging of other messages.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">[<em class="replaceable"><code>outdir</code></em>]</span></em></p>
                              <p>Folder on which to write logs generated by MessageLogger.
                                             This option overrides any log folders specified in either the
                                             default configuration file, or any configuration file provided on
                                             the command line using the <span class="literal">-c</span> option.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5551"></a>3.2.1.5.&nbsp;Logrotate
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p><span class="literal">Logrotate</span> is used to rotate, archive, 
                        		and delete old log files on a daily basis, which saves space on disk.  
                        		A logrotate configuration file, 
                        		<code class="filename">/etc/logrotate.d/bw_message_logger</code>, is set up 
                        		as part of the Server Tools installation.  For more information about 
                        		<span class="literal">logrotate</span>, please see the 
                        		<span class="literal">logrotate</span> manpage:
                     </p><pre class="programlisting">$ man 8 logrotate</pre><p>There are two issues to consider when customising the 
                        		<span class="literal">logrotate</span>:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>Log rotation can put a load on the logging machine.</p>
                           </li>
                           <li>
                              <p>If rotation is configured to occur more frequently, for 
                                 			example the rotation is changed to occur on hourly basis, then in 
                                 			this case the <code class="code">rotate</code> option should be updated to 
                                 			168 (i.e. 7 x 24) to ensure that the log files cover the same 
                                 			period of time.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_StatLogger"></a>3.2.2.&nbsp;StatLogger
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>Written in Python, StatLogger is a daemon process that runs in the
                           background, polling all servers on the network at regular intervals (by
                           default, every 2 seconds). Any computer running BWMachined will be
                           automatically discovered, along with any BigWorld components running on
                           that machine. StatLogger collects and logs information for every server
                           component discovered, regardless of which user is running them.
                  </p>
                  <p>Statistics for machines and processes are collected in 2
                           ways:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p>Communication with BWMachined daemons running on each
                                        computer.
                           </p>
                        </li>
                        <li>
                           <p>Requests made directly to the processes via the Watcher
                                        mechanism.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p>Once collected, StatLogger logs this data to a MySQL database. For
                           details on the structure of the database, see <a href="ch03.html#xref_Statistics_Database_Structure" title="3.2.2.6.2.&nbsp;Statistics Database Structure">Statistics Database Structure</a>.
                  </p>
                  <p>The main objective of StatLogger is to collect and store data in a
                           format that can be used by StatGrapher (for details, see <a href="ch03.html#xref_StatGrapher" title="3.1.1.3.&nbsp;StatGrapher">StatGrapher</a>), which is the visualisation counterpart
                           to StatLogger, and presents the data in a graphical format. Together,
                           StatLogger and StatGrapher are a replacement for the now defunct server
                           tool GMeter.
                  </p>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5606"></a>3.2.2.1.&nbsp;Requirements
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The list below describes the requirement for running
                                StatLogger:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis">CPU</em></p>
                              <p>On an Athlon 2700+, monitoring 230 processes (which includes
                                             200 CellApps) with StatLogger consumes roughly a constant 15% of
                                             available CPU time. The MySQL daemon will also be subject to load
                                             due to the large amount of database queries being generated &#8212;
                                             tests showed 5.5% of CPU time being used at a constant
                                             rate.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Disk</em></p>
                              <p>Due to the amount of data being collected, StatLogger can
                                             potentially consume a lot of disk space. The rate at which disk
                                             space is consumed depends on the amount of machines and server
                                             process for which statistics are collected. 4GB is recommended for
                                             a large amount of processes (around 250) and machines over a
                                             month. The disk space consumption rate of a single log gets
                                             smaller the longer a log is run, since StatLogger stores older
                                             data in lower detail than newer data.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Network</em></p>
                              <p>StatLogger's network requirements depend on the number of
                                             server machines and components present. It can potentially require
                                             a large amount of network throughput. For example, 230 processes
                                             and 9 server machines require 100Kb/s of downstream traffic, and
                                             20kb/s of upstream traffic, while 6 processes
                                             (<em class="emphasis">i.e.</em>, for a minimal server) and 9 server
                                             machines require 4kb/s of downstream and 2kb/s of upstream
                                             traffic.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">RAM</em></p>
                              <p>Memory requirements are low, as statistics are immediately
                                             logged to the database, rather than being kept in memory. Tests
                                             indicate an average usage of memory between 7MB to 10MB,
                                             regardless of the amount of processes running.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Software</em></p>
                              <p>MySQL 4.1+ and Python 2.4 with MySQLdb (officially known as
                                             mysql-python, available at
                                             http://sourceforge.net/projects/mysql-python. It should be
                                             available as a package for every common Linux distribution)
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>Also, StatLogger must be run on the same local network as the
                                servers. This is due to the machine and server component discovery,
                                which only searches the local network.
                     </p>
                     <p>StatLogger requires a valid MySQL user with access to create
                                databases. Normally the creation and configuration of this MySQL user
                                is handled during the tools installation script (for details, see the
                                document <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Server
                                   Tools Installation Guide</span>), but an existing database user can
                                be can used instead, by manually editing the configuration file. For
                                details, see <a href="ch03.html#xref_StatLogger_Configuration" title="3.2.2.5.&nbsp;Configuration">Configuration</a>.
                     </p>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5654"></a>3.2.2.2.&nbsp;Installation
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Located in <span class="literal">bigworld/tools/server/stat_logger</span>,
                                the StatLogger script is part of the BigWorld package.
                     </p>
                     <p>The tools installation script should be run before using
                                StatLogger, as it performs the following actions:
                     </p>
                     <div class="orderedlist">
                        <ol type="1">
                           <li>
                              <p>Creates the MySQL user with the appropriate permissions for
                                             StatLogger, and sets the configuration file to use this
                                             user.
                              </p>
                           </li>
                           <li>
                              <p>Installs init scripts into <span class="literal">/etc/init.d</span>,
                                             to enable running StatLogger as a daemon.
                              </p>
                           </li>
                        </ol>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_Usage"></a>3.2.2.3.&nbsp;Usage
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The script can be run from the command line, or it can be run in
                                daemon mode with the use of a startup script created during the tool
                                installation routine and placed in
                                <span class="literal">/etc/init.d/bw_stat_logger</span>.
                     </p>
                     <p>This script should be run as the root user, and can be run with
                                the following actions:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">start</span></em></p>
                              <p>Starts StatLogger.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">stop</span></em></p>
                              <p>Stops StatLogger.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">restart</span></em></p>
                              <p>Restarts StatLogger.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">status</span></em></p>
                              <p>Shows the current status of StatLogger.</p>
                           </li>
                        </ul>
                     </div>
                     <p>Although in most cases stat_logger.py will not need any
                                arguments when run from the command line, it provides the following
                                options
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-h
                                                   --help</span></em></p>
                              <p>Show script's help message.</p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-f
                                                   <em class="replaceable"><code>&lt;pref_file&gt;</code></em>
                                                   --config-file=<em class="replaceable"><code>&lt;pref_file&gt;</code></em></span></em></p>
                              <p>Specifies a preference file to use instead of the default
                                             preferences.xml.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-n
                                                   <em class="replaceable"><code>&lt;db_name&gt;</code></em>
                                                   --database-name=<em class="replaceable"><code>&lt;db_name&gt;</code></em></span></em></p>
                              <p>Specified the name of the database to use. If the database
                                             does not exist, then it will be automatically created, unless
                                             <span class="literal">-p</span> was specified. Note: If using an existing
                                             database, it is recommended to enable --use-db-prefs as
                                             well.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-p
                                                   --no-auto-create-db</span></em></p>
                              <p>Prevents creation of a new log database under any
                                             circumstance.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">--pid=<em class="replaceable"><code>&lt;pid_file&gt;</code></em></span></em></p>
                              <p><em class="emphasis">Daemon mode option. Although available for
                                                command-line use, the use of this type of option is recommended
                                                only for advanced users.</em></p>
                              <p>Specifies location to store PID file.</p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">--use-db-prefs</span></em></p>
                              <p>Retrieves and uses preferences from the log database being
                                             used (ignores preference file).
                              </p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-l
                                                   --list</span></em></p>
                              <p>Prints a list of log databases.</p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-o
                                                   <em class="replaceable"><code>&lt;out_file&gt;</code></em>
                                                   --output=<em class="replaceable"><code>&lt;out_file&gt;</code></em></span></em></p>
                              <p>Logs file to dump message output (default is stdout).</p>
                           </li>
                        </ul>
                     </div>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-e
                                                   <em class="replaceable"><code>&lt;out_file&gt;</code></em>
                                                   --erroutput=<em class="replaceable"><code>&lt;out_file&gt;</code></em></span></em></p>
                              <p>Logs file to dump error output (default is stderr).</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-d
                                                   --daemon</span></em></p>
                              <p>Runs StatLogger in daemon mode (default is to run in
                                             foreground).
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">--winpdb</span></em></p>
                              <p>Allow a Winpdb client to attach upon starting up. Winpdb is
                                             available at http://www.digitalpeers.com/pythondebugger.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">--home=<em class="replaceable"><code>&lt;path&gt;</code></em></span></em></p>
                              <p><em class="emphasis">Daemon mode option. Although available for
                                                command-line use, the use of this type of option is recommended
                                                only for advanced users.</em></p>
                              <p>Specifies home folder of StatLogger (default is bigworld/
                                             tools/server/stat_logger).
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e5841"></a>3.2.2.4.&nbsp;Output
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>StatLogger outputs various status messages describing which
                                machines and processes it discovers or loses
                                (<em class="emphasis">i.e.</em>, from the process or machine shutting down)
                                from the network, each prefixed with a timestamp.
                     </p>
                     <p>When running StatLogger manually, it by default prints this
                                information to the terminal in which it is run (unless the
                                <span class="literal">-o</span> option is specified).
                     </p>
                     <p>When installed as a daemon, these messages are output to
                                /var/log/bigworld/ stat_logger.out by default.
                     </p>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_StatLogger_Configuration"></a>3.2.2.5.&nbsp;Configuration
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Located in StatLogger's folder, the preference file
                                preferences.xml is used to configure the script. Apart from the
                                database user configuration, in most cases the provided standard
                                settings should be sufficient for development and production
                                environments.
                     </p>
                     <p>The preferences.xml file configures database setup options, as
                                well as what data StatLogger should collect from the server components
                                and machines.
                     </p>
                     <p>The example below illustrates the basic structure of a
                                configuration:
                     </p><pre class="programlisting">&lt;preferences&gt;
  &lt;options&gt;
  ...
  &lt;/options&gt;

  &lt;collect&gt;
    ?&lt;aggregation&gt;
     ...
     &lt;/aggregation&gt;

    ?&lt;processList&gt;
      *&lt;process&gt;
        ?&lt;statisticList&gt;
          *&lt;statistic&gt;
           ...

    ?&lt;machineStatisticList&gt;
      *&lt;statistic&gt;
       ...
       &lt;/statistic&gt;
     &lt;/machineStatisticList&gt;

    ?&lt;allProcessStatisticList&gt;
      *&lt;statistic&gt;
       ...
       &lt;/statistic&gt;
     &lt;/allProcessStatisticList&gt;
  &lt;/collect&gt;

&lt;/preferences&gt;</pre><p><span class="citetitle">StatLogger's <span class="literal">preferences.xml</span> &#8212;
                                   Basic structure</span></p>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Option_Configuration"></a>3.2.2.5.1.&nbsp;Option Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The options section contains the following tags:</p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p><em class="emphasis"><span class="literal">dbHost</span></em></p>
                                 <p>Hostname or IP address of the MySQL database server that
                                                  will contain the log databases.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">dbUser</span></em></p>
                                 <p>Database user with which StatLogger (and StatGrapher) will
                                                  access the database. For details on StatGrapher, see <a href="ch03.html#xref_StatGrapher" title="3.1.1.3.&nbsp;StatGrapher">StatGrapher</a>.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">dbPass</span></em></p>
                                 <p>Database user's password.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">dbPort</span></em></p>
                                 <p>Port on which the MySQL server is listening for
                                                  connections.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">dbPrefix</span></em></p>
                                 <p>Prefix of database names which StatLogger can
                                                  accesses.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">sampleTickInterval</span></em></p>
                                 <p>Interval in seconds at which StatLogger will poll the
                                                  components and store statistics &#8212; decimals are supported.
                                                  Generally this value does not need to be changed &#8212; if it does,
                                                  then it should not be any smaller than 2 seconds (the
                                                  recommended value).
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Aggregation_Window_Configuration"></a>3.2.2.5.2.&nbsp;Aggregation Window Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>This collect/aggregation/window section configures the
                                     aggregation windows that will be stored in the database.
                        </p>
                        <p>StatLogger has been designed so that it stores multiple
                                     versions of data at varying levels of detail &#8212; the idea is that
                                     long-term data does not need to be stored at the same level of
                                     detail as the more recent, short-term data.
                        </p>
                        <p>StatLogger requires at least one aggregation window setting in
                                     this section with a samplePeriodTicks value of 1.
                        </p>
                        <p>Multiple aggregation window setting takes the form of:</p><pre class="programlisting">&lt;preferences&gt;
  ...
  &lt;collect&gt;
    &lt;aggregation&gt;
      *&lt;window&gt;
         &lt;samples&gt;           &lt;num_samples_in_this_win&gt;   &lt;/samples&gt;
         &lt;samplePeriodTicks&gt; &lt;num_of_ticks_per_sec&gt;      &lt;/samplePeriodTicks&gt;
       &lt;/window&gt;
      ...</pre><p><span class="citetitle">Multiple aggregation window settings &#8212;
                                        Grammar</span></p>
                        <p>There are some constraints that must be adhered to when
                                     creating this list of aggregation window settings:
                        </p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p>There must always be an aggregation window with
                                                  samplePeriodTicks value of 1.
                                 </p>
                              </li>
                              <li>
                                 <p>Aggregation window settings must be ordered in ascending
                                                  order by their samplePeriodTicks value, with the smallest values
                                                  first.
                                 </p>
                              </li>
                              <li>
                                 <p>Each successive aggregation window should cover a larger
                                                  range of ticks than the previous one. The tick range is
                                                  calculated by multiplying samples value by the samplePeriodTicks
                                                  value (<em class="emphasis">i.e.</em>, number of samples x ticks
                                                  consolidated into one sample).
                                 </p>
                              </li>
                              <li>
                                 <p>Each successive samplePeriodTicks value must be a multiple
                                                  of the samplePeriodTicks value from the previous window.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>These aggregation windows are used directly by StatGrapher, so
                                     it is advised not to have large discrepancies between the
                                     samplePeriodTick values of successive aggregation windows.
                                     Furthermore, the final aggregation window setting should not have a
                                     large samples value, as this may place a very heavy load on
                                     StatGrapher, both on the server running WebConsole, as well as the
                                     Flash-based client.
                        </p>
                        <p>An example aggregation section is shown below, with a samples
                                     value of 365:
                        </p><pre class="programlisting">&lt;preferences&gt;
  ...
  &lt;collect&gt;
    &lt;aggregation&gt;

      &lt;!-- Every sample (2secs) in most recent 24hrs. 43200 samples --&gt;
      &lt;window&gt;
        &lt;samples&gt;           43200 &lt;/samples&gt;
        &lt;samplePeriodTicks&gt; 1     &lt;/samplePeriodTicks&gt;
      &lt;/window&gt;

      &lt;!-- Every 10th sample (20secs) in most recent 48hrs. 8760samples --&gt;
      &lt;window&gt;
        &lt;samples&gt;           8760  &lt;/samples&gt;
        &lt;samplePeriodTicks&gt; 10    &lt;/samplePeriodTicks&gt;
      &lt;/window&gt;

      &lt;!-- Every 150th sample (5mins) in most recent 30 days. 8760 samples --&gt;
      &lt;window&gt;
        &lt;samples&gt;           8760  &lt;/samples&gt;
        &lt;samplePeriodTicks&gt; 150   &lt;/samplePeriodTicks&gt;
      &lt;/window&gt;

      &lt;!-- Every 1800th sample (60mins) in most rcnt 365 days. 8760 samples --&gt;
      &lt;window&gt;
        &lt;samples&gt;           8760  &lt;/samples&gt;
        &lt;samplePeriodTicks&gt; 1800  &lt;/samplePeriodTicks&gt;
      &lt;/window&gt;

      &lt;!-- Every 43200th sample (1day) in most recent 365 days. 365 samples --&gt;
      &lt;window&gt;
        &lt;samples&gt;           365   &lt;/samples&gt;
        &lt;samplePeriodTicks&gt; 43200 &lt;/samplePeriodTicks&gt;
      &lt;/window&gt;
    &lt;/aggregation&gt;
   ...</pre><p><span class="citetitle">Multiple aggregation window settings &#8212;
                                        Example</span></p>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="d0e5966"></a>3.2.2.5.3.&nbsp;Machine Statistic Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The <span class="literal">collect/machineStatisticList</span> section is
                                     similar to <span class="literal">statisticList</span> (for details, see <a href="ch03.html#xref_Process_Statistic_Configuration" title="3.2.2.5.6.&nbsp;Process Statistic Configuration">Process Statistic Configuration</a>) and
                                     <span class="literal">allProcessStatisticList</span> (for details, see <a href="ch03.html#xref_Generic_Process_Statistic_Configuration" title="3.2.2.5.4.&nbsp;Generic Process Statistic Configuration">Generic Process Statistic Configuration</a>) sections,
                                     except in that watcher values are not supported (since machines do
                                     not have a Watcher interface), and hence, the
                                     <span class="literal">valueAt</span> settings only support strings
                                     representing members of the <span class="literal">Machine</span> class defined
                                     in <span class="literal">bigworld/tools/
                                        server/pycommon/cluster.py</span>.
                        </p>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Generic_Process_Statistic_Configuration"></a>3.2.2.5.4.&nbsp;Generic Process Statistic Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The <span class="literal">collect/allProcessStatisticList</span> section
                                     is similar to the <span class="literal">statisticList</span> (for details, see
                                     <a href="ch03.html#xref_Process_Statistic_Configuration" title="3.2.2.5.6.&nbsp;Process Statistic Configuration">Process Statistic Configuration</a>) section,
                                     except in that its statistics are regarded as common to all
                                     processes being monitored &#8212; <em class="emphasis">i.e.</em>, those
                                     specified in the <span class="literal">processList</span> section (for
                                     details, see <a href="ch03.html#xref_Process_Configuration" title="3.2.2.5.5.&nbsp;Process Configuration">Process Configuration</a>).
                        </p>
                        <p>It is recommended that any watcher values used in this section
                                     be supported by all processes being monitored, although StatLogger
                                     will store empty values for processes that do not support a watcher
                                     value.
                        </p>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Process_Configuration"></a>3.2.2.5.5.&nbsp;Process Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The <span class="literal">collect/processList/process</span> section
                                     configures the statistics that will be collected for each process &#8212;
                                     there must be one process section for each server component to be
                                     monitored
                        </p>
                        <p>The process section contains the following tags:</p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p><em class="emphasis"><span class="literal">name</span></em></p>
                                 <p>Display name for the process type.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">matchtext</span></em></p>
                                 <p>Name of the component type's executable. Value must be in
                                                  lowercase, like the executable names.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">statisticList</span></em></p>
                                 <p>List of statistics to be collected for this process by
                                                  StatLogger &#8212; for details, see section <a href="ch03.html#xref_Process_Statistic_Configuration" title="3.2.2.5.6.&nbsp;Process Statistic Configuration">Process Statistic Configuration</a>.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>An example process section is shown below:</p><pre class="programlisting">&lt;preferences&gt;
  ...
  &lt;collect&gt;
    ...
    &lt;processList&gt;
      &lt;process&gt;
        &lt;name&gt;      CellApp &lt;/name&gt;
        &lt;matchtext&gt; cellapp &lt;/name&gt;
        &lt;statisticList&gt;
          ...
        &lt;/statisticList&gt;
      &lt;/process&gt;
      ...</pre><p><span class="citetitle">Process configuration &#8212; Example</span></p>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Process_Statistic_Configuration"></a>3.2.2.5.6.&nbsp;Process Statistic Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The collect/processList/process/statisticList/statistic
                                     section specifies the statistics that must be collected for each
                                     process.
                        </p>
                        <p>The statistic section contains the following tags:</p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p><em class="emphasis"><span class="literal">name</span></em></p>
                                 <p>Display name for the statistic type.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">valueAt</span></em></p>
                                 <p>Where to retrieve the values from &#8212; there are two distinct
                                                  sources of information, depending on the first character of this
                                                  tag's value:
                                 </p>
                                 <p><em class="emphasis">If first character is a slash
                                                     (<span class="literal">/</span>)</em></p>
                                 <p><span class="literal">valueAt</span> will be interpreted as a
                                                  watcher. The best way to list the watchers that can be graphed
                                                  is via the WebConsole's ClusterControl module (for details, see
                                                  <a href="ch03.html#xref_ClusterControl" title="3.1.1.1.&nbsp;ClusterControl">ClusterControl</a>).
                                 </p>
                                 <p>Any single scalar value present in ClusterControl can be
                                                  added to StatGrapher (including any new ones that you have
                                                  created yourself).
                                 </p>
                                 <p><em class="emphasis">Example</em>:
                                                  <span class="literal">/stats/numInAoI</span></p>
                                 <p><em class="emphasis">If first character is not a slash
                                                     (<span class="literal">/</span>)</em></p>
                                 <p>Any <span class="literal">valueAt</span> string that does not begin
                                                  with a slash is regarded as a Process class defined in script
                                                  <span class="literal">bigworld/tools/server/pycommon/cluster.py</span>.
                                 </p>
                                 <p>In this case, the string refers to the member of the
                                                  <span class="literal">Process</span> class that StatLogger should
                                                  retrieve. (Strictly speaking, <span class="literal">valueAt</span> is
                                                  <span class="literal">eval</span>'ed against the Process object, which is
                                                  slightly more flexible than just being able to reference class
                                                  members).
                                 </p>
                                 <p><em class="emphasis">Example:</em>
                                                  <span class="literal">mem</span> &#8212; This is <span class="literal">eval</span>'ed to
                                                  <span class="literal">Process.mem</span>, which retrieves the value of
                                                  memory usage of a process.
                                 </p>
                                 <p><em class="emphasis">Note</em>: Caution is required
                                                  with this type of value, as it is possible to use a function
                                                  call that changes the state of the process
                                                  (<em class="emphasis">e.g.</em>, causing a process to shutdown). It
                                                  is highly unlikely that this will occur by accident, unless the
                                                  exact function call is entered in the <span class="literal">valueAt</span>
                                                  setting.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">maxAt</span></em></p>
                                 <p>Not explicitly used in StatLogger &#8212; however it is used by
                                                  StatGrapher to determine the scale of the graph.
                                 </p>
                                 <p><em class="emphasis">Note:</em> For some watcher
                                                  values (which are simply constantly increasing values with no
                                                  upper bound), there is no appropriate <span class="literal">maxAt</span>
                                                  value. In this case just set it to an arbitrary value, as these
                                                  are not likely to be displayed in StatLogger.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">type</span></em></p>
                                 <p>Unused as of BigWorld 1.8.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">consolidate</span></em></p>
                                 <p>Consolidation function to use when moving data up an
                                                  aggregation window.
                                 </p>
                                 <p>Possible values are: <span class="literal">MAX</span>,
                                                  <span class="literal">MIN</span>, and <span class="literal">AVG</span>.
                                 </p>
                                 <p><em class="emphasis">Example</em>: We consolidate
                                                  four data samples at 4 seconds per sample into the next
                                                  aggregation window, which stores data at 16 seconds per sample.
                                                  The data represents CPU load consumed by a process. The
                                                  <span class="literal">consolidate</span> value is specified as
                                                  <span class="literal">AVG</span>, so StatLogger averages the four data
                                                  samples, then store this value as a single value in the higher
                                                  aggregation window.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">display</span></em></p>
                                 <p>Contains two tags that affect the appearance of the
                                                  statistic in StatGrapher:
                                 </p>
                                 <div class="itemizedlist">
                                    <ul type="circle">
                                       <li>
                                          <p><em class="emphasis"><span class="literal">colour</span>
                                                                  </em>&#8212; Colour (in hexadecimal RGB) to represent this
                                                               statistic in StatGrapher.
                                          </p>
                                       </li>
                                       <li>
                                          <p><em class="emphasis"><span class="literal">show</span></em> &#8212; Sets
                                                               whether StatGrapher shows this statistic by default.
                                                               Possible values are true and false
                                          </p>
                                       </li>
                                       <li>
                                          <p><em class="emphasis"><span class="literal">description</span></em> &#8212; 
                                                               Description of this statistic.  This will be displayed in 
                                             				  the tooltip when the user mouse over this statistic in the 
                                             				  Legend section of the StatGrapher in the WebConsole.
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                        <p>An example statisticList section is shown below:</p><pre class="programlisting">&lt;preferences&gt;
  ...
  &lt;collect&gt;
    ...
    &lt;processList&gt;
      &lt;process&gt;
        &lt;name&gt;      CellApp &lt;/name&gt;
        &lt;matchtext&gt; cellapp &lt;/name&gt;
        &lt;statisticList&gt;
          &lt;statistic&gt;
            &lt;name&gt;        Cell Load                &lt;/name&gt;
            &lt;valueAt&gt;     /load                    &lt;/valueAt&gt;
            &lt;maxAt&gt;       1.0                      &lt;/maxAt&gt;
            &lt;logicalMax&gt;  None                     &lt;/logicalMax&gt;
            &lt;type&gt;        FLOAT                    &lt;/type&gt;
            &lt;consolidate&gt; AVG                      &lt;/consolidate&gt;
            &lt;display&gt;
              &lt;colour&gt;    #FF6600                  &lt;/colour&gt;
              &lt;show&gt;      true                     &lt;/show&gt;
              &lt;description&gt;      
                  The load of this CellApp.
              &lt;/description&gt;
            &lt;/display&gt;
          &lt;/statistic&gt;
          &lt;statistic&gt;
            &lt;name&gt;        Num Entities Ever        &lt;/name&gt;
            &lt;valueAt&gt;     /stats/totalEntitiesEver &lt;/valueAt&gt;
            &lt;maxAt&gt;       10000.0                  &lt;/maxAt&gt;
            &lt;type&gt;        FLOAT                    &lt;/type&gt;
            &lt;consolidate&gt; MAX                      &lt;/consolidate&gt;
            &lt;display&gt;
              &lt;colour&gt;    #663366                  &lt;/colour&gt;
              &lt;show&gt;      false                    &lt;/show&gt;
              &lt;description&gt;      
                  The number of entities created on the CellApp since server startup.
              &lt;/description&gt;
            &lt;/display&gt;
          &lt;/statistic&gt;
          &lt;statistic&gt;
            &lt;name&gt;        Process CPU              &lt;/name&gt;
            &lt;valueAt&gt;     load                     &lt;/valueAt&gt;
            &lt;maxAt&gt;       1.0                      &lt;/maxAt&gt;
            &lt;type&gt;        FLOAT                    &lt;/type&gt;
            &lt;consolidate&gt; AVG                      &lt;/consolidate&gt;
            &lt;display&gt;
              &lt;colour&gt;    #FF0000                  &lt;/colour&gt;
              &lt;show&gt;      true                     &lt;/show&gt;
              &lt;description&gt;
                  The percentage of the CPU time allocated to the process.
              &lt;/description&gt;
            &lt;/display&gt;
          &lt;/statistic&gt;
          ...</pre><p><span class="citetitle">Process statistic configuration &#8212;
                                        Example</span></p>
                        <div class="sect5" lang="en">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h6 class="title"><a name="d0e6230"></a>3.2.2.5.6.1.&nbsp;Useful Configuration Values for Processes and
                                                   Machines
                                    </h6>
                                 </div>
                              </div>
                           </div>
                           <p>The table below lists some recommended values for process
                                          statistic configuration (for details, see <a href="ch03.html#xref_Generic_Process_Statistic_Configuration" title="3.2.2.5.4.&nbsp;Generic Process Statistic Configuration">Generic Process Statistic Configuration</a>):
                           </p>
                           <div class="altrow">
                              <table border="0">
                                 <colgroup>
                                    <col width="70">
                                    <col width="90">
                                    <col width="140">
                                    <col width="48">
                                 </colgroup>
                                 <thead>
                                    <tr>
                                       <th>&nbsp;</th>
                                       <th><span class="literal">&lt;name&gt;</span></th>
                                       <th><span class="literal">&lt;valueAt&gt;</span></th>
                                       <th><span class="literal">&lt;max&gt;</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr>
                                       <td rowspan="13"><em class="emphasis">CellApp</em></td>
                                       <td>Cell Load</td>
                                       <td><span class="literal">/load</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Cell Spare Time</td>
                                       <td><span class="literal">/nub/spare time</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Cell Backlog</td>
                                       <td><span class="literal">/nub/receive queue</span></td>
                                       <td>1048576</td>
                                    </tr>
                                    <tr>
                                       <td>Max Tick Period</td>
                                       <td><span class="literal">/resetOnRead/maxTickPeriod</span></td>
                                       <td>0.2</td>
                                    </tr>
                                    <tr>
                                       <td>Num Entities</td>
                                       <td><span class="literal">/stats/numEntities1</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num RealEntities</td>
                                       <td><span class="literal">/stats/numRealEntities</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num Witnesses</td>
                                       <td><span class="literal">/stats/numWitnesses</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num Entities Ever</td>
                                       <td><span class="literal">/stats/totalEntitiesEver</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num RealEntities Ever</td>
                                       <td><span class="literal">/stats/totalRealEntitiesEver</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num Witnesses Ever</td>
                                       <td><span class="literal">/stats/totalWitnessesEver</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num In AoI</td>
                                       <td><span class="literal">/stats/numInAoI</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num In AoI Ever</td>
                                       <td><span class="literal">/stats/totalInAoIEver</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Cell scale back</td>
                                       <td><span class="literal">/throttle/value</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td rowspan="3"><em class="emphasis">BaseApp</em></td>
                                       <td>BaseApp Load</td>
                                       <td><span class="literal">/load</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num Bases</td>
                                       <td><span class="literal">/numBases</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Num Proxies</td>
                                       <td><span class="literal">/numProxies</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td rowspan="5"><em class="emphasis">BaseAppMgr</em></td>
                                       <td>Max BaseApp Load</td>
                                       <td><span class="literal">/baseAppLoad/max</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Average BaseApp Load</td>
                                       <td><span class="literal">/baseAppLoad/average</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Min BaseApp Load</td>
                                       <td><span class="literal">/baseAppLoad/min</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Total Bases</td>
                                       <td><span class="literal">/numBases</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Total Proxies</td>
                                       <td><span class="literal">/numProxies</span></td>
                                       <td>10000.0</td>
                                    </tr>
                                    <tr>
                                       <td rowspan="5"><em class="emphasis">CellAppMgr</em></td>
                                       <td>Max CellApp Load</td>
                                       <td><span class="literal">/cellAppLoad/max</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Avg CellApp Load</td>
                                       <td><span class="literal">/cellAppLoad/average</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Min CellApp Load</td>
                                       <td><span class="literal">/cellAppLoad/min</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Total Entities</td>
                                       <td><span class="literal">/numEntities</span></td>
                                       <td>50000.0</td>
                                    </tr>
                                    <tr>
                                       <td>Number of Cells</td>
                                       <td><span class="literal">/numCells</span></td>
                                       <td>20</td>
                                    </tr>
                                    <tr>
                                       <td rowspan="2"><em class="emphasis">All
                                                                   processes</em></td>
                                       <td>Process CPU</td>
                                       <td><span class="literal">load</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Process Memory</td>
                                       <td><span class="literal">mem</span></td>
                                       <td>1.0</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                           <p>The table below lists some recommended values for machine
                                          statistic configuration:
                           </p>
                           <div class="altrow">
                              <table border="0">
                                 <colgroup>
                                    <col width="70">
                                    <col width="90">
                                    <col width="140">
                                    <col width="48">
                                 </colgroup>
                                 <thead>
                                    <tr>
                                       <th>&nbsp;</th>
                                       <th><span class="literal">&lt;name&gt;</span></th>
                                       <th><span class="literal">&lt;valueAt&gt;</span></th>
                                       <th><span class="literal">&lt;max&gt;</span></th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr>
                                       <td rowspan="12"><em class="emphasis">Machines</em></td>
                                       <td>Machine CPU</td>
                                       <td><span class="literal">load()</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Machine Mem</td>
                                       <td><span class="literal">mem</span></td>
                                       <td>1.0</td>
                                    </tr>
                                    <tr>
                                       <td>Machine Recv Loss</td>
                                       <td><span class="literal">inDiscards</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Machine Send Loss</td>
                                       <td><span class="literal">outDiscards</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Packets In (eth0)</td>
                                       <td><span class="literal">ifStats["eth0"].packIn</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Packets Out (eth0)</td>
                                       <td><span class="literal">ifStats["eth0"].packOut</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Bits In (eth0)</td>
                                       <td><span class="literal">ifStats["eth0"].bitsIn</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Bits Out (eth0)</td>
                                       <td><span class="literal">ifStats["eth0"].bitsOut</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Packets In (eth1)</td>
                                       <td><span class="literal">ifStats["eth1"].packIn</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Packets Out (eth1)</td>
                                       <td><span class="literal">ifStats["eth1"].packOut</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Bits In (eth1)</td>
                                       <td><span class="literal">ifStats["eth1"].bitsIn</span></td>
                                       <td>256</td>
                                    </tr>
                                    <tr>
                                       <td>Bits Out (eth1)</td>
                                       <td><span class="literal">ifStats["eth1"].bitsOut</span></td>
                                       <td>256</td>
                                    </tr>
                                 </tbody>
                              </table>
                           </div>
                        </div>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="d0e6617"></a>3.2.2.5.7.&nbsp;Further Notes on Configuration
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>The configuration file directly affects the database structure
                                     used for storing the statistics. If the collect section of the
                                     configuration file is changed, then StatLogger will detect the
                                     change when it is next run, and will subsequently create a new
                                     statistics database from scratch, in order to accommodate the new
                                     structure.
                        </p>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e6622"></a>3.2.2.6.&nbsp;Database
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The sections below describe the databases used by StatLogger and
                                the tables in the statistics database.
                     </p>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="d0e6627"></a>3.2.2.6.1.&nbsp;Naming and Creation
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>StatLogger might end up using many databases on the MySQL
                                     server, although the minimum required is two &#8212; one for actual
                                     statistics, and one for the meta-database that keeps track of all
                                     the statistics databases.
                        </p>
                        <p>By default, the meta-database is named
                                     <span class="literal">bw_stat_log_info</span>, and contains a single table
                                     called <span class="literal">bw_stat_log_databases</span>, which holds the
                                     names of the statistics databases. The meta-database is always
                                     created if it does not exist in the MySQL server.
                        </p>
                        <p>The statistics databases by default are named
                                     <span class="literal">bw_stat_log_data<em class="replaceable"><code>&lt;n&gt;</code></em></span>,
                                     where <span class="literal"><em class="replaceable"><code>&lt;n&gt;</code></em></span> is the
                                     incremental database number. However, users can choose to create
                                     statistics databases with specific names, using the
                                     <span class="literal">-n</span> option when running StatLogger &#8212; for details,
                                     see <a href="ch03.html#xref_Usage" title="3.2.2.3.&nbsp;Usage">Usage</a>.
                        </p>
                        <p>New statistics databases are created in the following
                                     situations:
                        </p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p>There are no statistics databases in the MySQL
                                                  server.
                                 </p>
                              </li>
                              <li>
                                 <p>The preferences file was structurally changed, which
                                                  causes a new statistic database to be created &#8212; for details on
                                                  preferences.xml, see <a href="ch03.html#xref_StatLogger_Configuration" title="3.2.2.5.&nbsp;Configuration">Configuration</a>.
                                 </p>
                              </li>
                              <li>
                                 <p>StatLogger was started with the <span class="literal">-n
                                                     <em class="replaceable"><code>&lt;database_name&gt;</code></em></span>
                                                  command-line option, and there was no statistic database with
                                                  that name in the MySQL server.
                                 </p>
                              </li>
                           </ul>
                        </div>
                        <p>Typically, only one statistics database will be needed once
                                     StatLogger has been properly configured. There is usually no need to
                                     arbitrarily create new statistics databases, unless isolated sets of
                                     statistics are needed (which might be the case when performing tests
                                     with the BigWorld server).
                        </p>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Statistics_Database_Structure"></a>3.2.2.6.2.&nbsp;Statistics Database Structure
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>Below is an overview of the tables in a statistics
                                     database:
                        </p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p><em class="emphasis"><span class="literal">pref_processes</span></em></p>
                                 <p>Process preferences specified in configuration file's
                                                  collect/ processList section. For details, see <a href="ch03.html#xref_Process_Configuration" title="3.2.2.5.5.&nbsp;Process Configuration">Process Configuration</a>.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">pref_statistics</span></em></p>
                                 <p>Statistic preferences specified in configuration
                                                  file.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">seen_machines</span></em></p>
                                 <p>Machines observed while StatLogger was running.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">seen_processes</span></em></p>
                                 <p>Processes observed while StatLogger was running.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">seen_users</span></em></p>
                                 <p>Users observed while StatLogger was running.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">stat_<em class="replaceable"><code>&lt;proc&gt;</code></em>_lvl_<em class="replaceable"><code>&lt;lvl&gt;</code></em></span></em></p>
                                 <p>Statistics collected for processes of type
                                                  <span class="literal"><em class="replaceable"><code>&lt;proc&gt;</code></em></span>, with
                                                  <span class="literal"><em class="replaceable"><code>&lt;lvl&gt;</code></em></span> index
                                                  of aggregation.
                                 </p>
                                 <p><em class="emphasis">Examples:</em>
                                                  <span class="literal">stat_baseapp_lvl_001</span>,
                                                  <span class="literal">stat_cellapp_lvl_004</span></p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">stat_machines_level_<em class="replaceable"><code>&lt;lvl&gt;</code></em></span></em></p>
                                 <p>Statistics collected for machines, with
                                                  <span class="literal"><em class="replaceable"><code>&lt;lvl&gt;</code></em></span> index
                                                  of aggregation &#8212; the higher the aggregation level, the lower the
                                                  resolution of the data being stored in that table
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">std_aggregation_windows</span></em></p>
                                 <p>Aggregation level details specified in configuration
                                                  file's collect/aggregation section.
                                 </p>
                                 <p>For details, see <a href="ch03.html#xref_Aggregation_Window_Configuration" title="3.2.2.5.2.&nbsp;Aggregation Window Configuration">Aggregation Window Configuration</a>.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">std_info</span></em></p>
                                 <p>Contains two pieces of information:</p>
                                 <div class="itemizedlist">
                                    <ul type="circle">
                                       <li>
                                          <p><span class="literal">sampleTickInterval</span> specified in the
                                                               configuration file's options section &#8212; for details, see
                                                               <a href="ch03.html#xref_Option_Configuration" title="3.2.2.5.1.&nbsp;Option Configuration">Option Configuration</a>.
                                          </p>
                                       </li>
                                       <li>
                                          <p>Database structure version (internally used by
                                                               StatLogger).
                                          </p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">std_session_times</span></em></p>
                                 <p>Start end times of when StatLogger was run.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">std_tick_times</span></em></p>
                                 <p>Timestamps of the start of each interval.</p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">std_touch_time</span></em></p>
                                 <p>Last time the database was written to, in database local
                                                  time.
                                 </p>
                                 <p>Only used by StatGrapher (for details, see <a href="ch03.html#xref_StatGrapher" title="3.1.1.3.&nbsp;StatGrapher">StatGrapher</a>), whether StatLogger is currently
                                                  logging to this database or not.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="sect1" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="xref_Server_Command_Line_Utilities"></a>3.3.&nbsp;Server Command-Line Utilities
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_control_cluster_py"></a>3.3.1.&nbsp;<span class="literal">control_cluster.py</span></h3>
                        </div>
                     </div>
                  </div>
                  <p>Located under <span class="literal">bigworld/tools/server</span>, this tool
                           is used for managing a BigWorld cluster and the processes running on
                           it.
                  </p>
                  <p>For detailed information on actual usage, please see the online
                           help (with the <span class="literal">--help</span> switch).
                  </p>
                  <p>The options for invoking <span class="literal">control_cluster.py</span> are
                           described in the list below:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p><em class="emphasis"><span class="literal">start</span></em></p>
                           <p>Starts a server on the cluster.</p>
                           <p>The set of machines to be used can be specified in a number of
                                        different ways.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">stop</span></em></p>
                           <p>Stops a currently running server in the most controlled way
                                        possible.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">kill</span></em></p>
                           <p>Forces shutdown of server components with
                                        <span class="literal">SIGINT</span>.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">nuke</span></em></p>
                           <p>Forces shutdown of server components with
                                        <span class="literal">SIGQUIT</span>.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">restart</span></em></p>
                           <p>Restarts the server. Same as running with stop option, and
                                        then with start option.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">startproc</span></em></p>
                           <p>Starts a new server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">stopproc</span></em></p>
                           <p>Stops a specific server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">nukeproc</span></em></p>
                           <p>Kill a specific server process, and cause it to dump
                                        core.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">restartproc</span></em></p>
                           <p>Restarts a specific server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">killproc</span></em></p>
                           <p>Kills a specific server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">restartproc</span></em></p>
                           <p>Restarts a specific server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">display</span></em></p>
                           <p>Displays information about the currently running
                                        server.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">summary</span></em></p>
                           <p>Shows an abridged version of the display output.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">check</span></em></p>
                           <p>Indicates whether a server is running.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">checklayout</span></em></p>
                           <p>Indicates whether a server is running with a given
                                        layout.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">cinfo</span></em></p>
                           <p>Displays information about the machines on the cluster that
                                        are running BWMachined.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">netinfo</span></em></p>
                           <p>Show network statistics for a set of machines.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">users</span></em></p>
                           <p>Displays information about users who are running server
                                        processes on the cluster.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">save</span></em></p>
                           <p>Saves the current server layout to an XML file.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">load</span></em></p>
                           <p>Starts the server according to a layout from an XML
                                        file.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">watch</span></em></p>
                           <p>Queries watcher values from server processes. Also available
                                        under the command alias <span class="literal">get</span>.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">set</span></em></p>
                           <p>Sets a watcher value on one or more processes.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">set</span></em></p>
                           <p>Sets a watcher value on one or more processes.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">pyconsole</span></em></p>
                           <p>Telnets to the Python server port on a server process.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">runscript</span></em></p>
                           <p>Non-interactively run Python script on given processes.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">querytags</span></em></p>
                           <p>Queries BWMachined tags on the cluster.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">mdlist</span></em></p>
                           <p>Displays a comma-separated list of machines on the
                                        network.
                           </p>
                           <p>This is useful for passing to pdsh
                                        (http://www.llnl.gov/linux/pdsh/pdsh.html) or similar
                                        utilities.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">flush</span></em></p>
                           <p>Forces machines to flush their tag and user mappings.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">checkring</span></em></p>
                           <p>Discovers the machined buddy ring, and verifies its
                                        correctness.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">log</span></em></p>
                           <p>Sends a once-off log message to MessageLogger
                                        processes.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">pyprofile</span></em></p>
                           <p>Print a report on Python profiling.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">cprofile</span></em></p>
                           <p>Print a report on internal BigWorld profiling on
                                        processes.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">eventprofile</span></em></p>
                           <p>Print a report on script method and data propagation
                                        profiling.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><span class="literal">mercuryprofile</span></em></p>
                           <p>Print a report on per-message-type profile statistics from
                                        processes.
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e7090"></a>3.3.2.&nbsp;<span class="literal">eload</span> (Entity Loader)
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>The <span class="literal">eload</span> tool reads any entities from a file
                           formatted as a <span class="literal">.chunk</span> file, and instantiates them on
                           the base (or on the cell, if the <span class="literal">-cell</span> option is
                           used). For details on the format of <span class="literal">.chunk</span> files, see
                           the document <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Client
                              Programming Guide</span>'s chapter <span xmlns:xlink="http://www.w3.org/1999/xlink" class="olink">Chunks</span>.
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Note</h3>
                     <p>As of BigWorld 1.7, the purpose of eload (to automatically have
                                the server load entities in the space) is supported by WorldEditor &#8212;
                                hence this tool is deprecated.
                     </p>
                     <p>There are two suggested methods for interactively loading
                                entities on a running server:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p>The <span class="literal">runscript</span> utility &#8212; for details, see
                                             <a href="ch03.html#xref_runscript" title="3.3.5.&nbsp;runscript"><span class="literal">runscript</span></a>.
                              </p>
                           </li>
                           <li>
                              <p>Calling a loading function on the server, using a Python
                                             telnet console &#8212; for details, see <a href="ch03.html#xref_control_cluster_py" title="3.3.1.&nbsp;control_cluster.py"><span class="literal">control_cluster.py</span></a>.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e7134"></a>3.3.3.&nbsp;MessageLogger Related Utilities
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>For details on the tools available for interacting with server
                           message logs, see <a href="ch03.html#xref_Command_Line_Utilities" title="3.2.1.3.&nbsp;Command-Line Utilities">Command-Line Utilities</a>.
                  </p>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e7141"></a>3.3.4.&nbsp;<span class="literal">mls</span> (Machine List)
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>The tool <code class="code">mls</code> lists all machines on the local network
                           that are running BWMachined and processes registered with it.
                  </p>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Note</h3>
                     <p>As of BigWorld 1.7, the functionality of mls and other utilities
                                is provided by <span class="literal">control_cluster.py</span> (for details, see
                                <a href="ch03.html#xref_control_cluster_py" title="3.3.1.&nbsp;control_cluster.py"><span class="literal">control_cluster.py</span></a>).
                     </p>
                     <p>The <span class="literal">mls</span> utility now exists primarily as an
                                example of how to use the C++ side of the
                                <span class="literal">MachineGuardMessage</span> API in <span class="literal">src/lib/
                                   network/ machine_guard.[ch]pp</span> for talking to
                                BWMachined.
                     </p>
                     <p><em class="emphasis">This utility is no longer being actively developed,
                                   and should be considered deprecated.</em></p>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_runscript"></a>3.3.5.&nbsp;<span class="literal">runscript</span></h3>
                        </div>
                     </div>
                  </div>
                  <p>The runscript executable is a simple server-side tool that
                           interfaces with the cell and the base to execute arbitrary scripts for
                           the management of a BigWorld server.
                  </p>
                  <p>It is located in folder <span class="literal">bigworld/tools/server</span>,
                           and has the following syntax:
                  </p><pre class="programlisting">runscript [-base|-cell [-space &lt;spaceid&gt;]] [-all] [script]</pre><p>The options for invoking <span class="literal">run_script</span> are
                           described in the list below:
                  </p>
                  <div class="itemizedlist">
                     <ul type="disc">
                        <li>
                           <p><em class="emphasis"><code class="filename">-h
                                              --help</code></em></p>
                           <p>Displays command-line option help and exits.</p>
                        </li>
                        <li>
                           <p><em class="emphasis"><code class="filename">-base</code></em></p>
                           <p>Executes the script on BaseApp. By default, the least loaded
                                        BaseApp is used.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><code class="filename">-cell</code></em></p>
                           <p>Executes the script on CellApp. By default, the least loaded
                                        CellApp that has a space is used.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><code class="filename">-all</code></em></p>
                           <p>Modifies the option <span class="literal">-base</span> or
                                        <span class="literal">-cell</span> default to execute the script on all
                                        BaseApps and CellApps.
                           </p>
                        </li>
                        <li>
                           <p><em class="emphasis"><code class="filename">-space
                                              <em class="replaceable"><code>&lt;spaceid&gt;</code></em></code></em></p>
                           <p>Modifies the option <span class="literal">-cell</span> to execute only
                                        on a cell (or cells) in the space specified.
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Note</h3>Most of this functionality is supported by
                             <code class="code">control_cluster.py</code>. <code class="code">control_cluster.py</code> should
                             be preferred over using this tool.
                  </div>
               </div>
            </div>
            <div class="sect1" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="xref_Standard_GUI_Applications"></a>3.4.&nbsp;Standard GUI Applications
                        </h2>
                     </div>
                  </div>
               </div>
               <p>The section below described the following server GUI
                      applications:
               </p>
               <div class="itemizedlist">
                  <ul type="disc">
                     <li>
                        <p>BWPanel &#8212; See <a href="ch03.html#xref_BWPanel" title="3.4.1.&nbsp;BWPanel">BWPanel</a>.
                        </p>
                     </li>
                     <li>
                        <p>Space Viewer &#8212; See <a href="ch03.html#xref_Space_Viewer" title="3.4.2.&nbsp;Space Viewer">Space Viewer</a>.
                        </p>
                     </li>
                  </ul>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_BWPanel"></a>3.4.1.&nbsp;BWPanel
                           </h3>
                        </div>
                     </div>
                  </div>
                  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                     <h3 class="title">Note</h3>
                     <p>As of BigWorld 1.9, BWPanel is deprecated. All interactions with
                                the server (i.e. starting, stopping, interacting with watchers,
                                calling python script etc) are expected to be done with either Web
                                Console or the supported command-line utilities
                                (<code class="filename">control_cluster.py</code> and
                                <code class="filename">bot_op.py</code>). In particular, servers started with
                                BWPanel will not set the timing method from the
                                <code class="code">[TimingMethod]</code> section in
                                <code class="filename">/etc/bwmachined.conf</code>. You must manually export
                                <code class="code">BW_TIMING_METHOD</code> into your environment if you wish to use
                                <code class="code">gettimeofday </code>timing.
                     </p>
                  </div>
                  <p>A simple way to control the server during development is by using
                           the tool BWPanel. It is implemented as a simple script that displays a
                           list of buttons, which allow you to run other scripts. It is quite easy
                           to extend BWPanel with your own buttons, which are themselves just
                           scripts.
                  </p>
                  <p>Located on <span class="literal">bigworld/tools/server/bwpanel</span>, its
                           main window is displayed below:
                  </p>
                  <div class="informalfigure">
                     <div class="mediaobject"><img src="images/bwpanels_window.png"><span class="caption">
                           <p>BWPanel's window</p></span></div>
                  </div>
                  <p>BWPanel is designed for running the server on a single machine
                           during development. It is not designed for production use &#8212; for that
                           purpose, use WebConsole (for details, see <a href="ch03.html#xref_WebConsole" title="3.1.&nbsp;WebConsole">WebConsole</a>) or <span class="literal">control_cluster.py</span>
                           (for details, see <a href="ch03.html#xref_control_cluster_py" title="3.3.1.&nbsp;control_cluster.py"><span class="literal">control_cluster.py</span></a>).
                  </p>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e7309"></a>3.4.1.1.&nbsp;Standard Buttons on BWPanel
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The buttons on BWPanel are listed on the table below:</p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><span class="guilabel">Start the world &#8212; Detailed</span></p>
                              <p>Starts on the local machine all components required for a
                                             server, each on its own terminal.
                              </p>
                              <p>The components are started in the following order:
                                             CellAppMgr, BaseAppMgr, DBMgr, LoginApp, CellApp, and
                                             BaseApp.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Start the world &#8212; Brief</span></p>
                              <p>Starts on the local machine all components required for a
                                             server.
                              </p>
                              <p>It starts three terminals, as listed below:</p>
                              <div class="itemizedlist">
                                 <ul type="circle">
                                    <li>
                                       <p><em class="emphasis"><span class="literal">world</span></em> &#8212; DBMgr,
                                                          CellAppMgr, BaseAppMgr, and LoginApp
                                       </p>
                                    </li>
                                    <li>
                                       <p><em class="emphasis">CellApp</em> &#8212;
                                                          CellApp
                                       </p>
                                    </li>
                                    <li>
                                       <p><em class="emphasis">BaseApp</em> &#8212;
                                                          BaseApp
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                              <p>See also the <span class="guilabel">Stop the World</span> button
                                             .
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Add CellApp</span></p>
                              <p>Starts a CellApp process.</p>
                              <p>It starts an extra CellApp process for a single-machine
                                             server, which is useful for dual CPUs, or for testing multiple
                                             cells within a single machine.
                              </p>
                              <p>It can also start a CellApp by itself, on a separate machine
                                             that you wish to add to the server farm. To do this, run BWPanel
                                             under the same UID on another machine, and add a CellApp. The
                                             CellApp will register with the existing server, and start load
                                             balancing with the existing CellApps.
                              </p>
                              <p>The Python script <span class="literal">control_cluster.py</span> is a
                                             more convenient way to start CellApps on remote machines. For
                                             details, see <a href="ch03.html#xref_control_cluster_py" title="3.3.1.&nbsp;control_cluster.py"><span class="literal">control_cluster.py</span></a>.
                              </p>
                              <p>See also the <span class="guilabel">Stop the World</span>
                                             button.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Add BaseApp</span></p>
                              <p>Starts a BaseApp process on the local machine.</p>
                              <p>Similarly to the mechanism of the <span class="guilabel">Add
                                                CellApp</span> button, the new BaseApp will join the rest of
                                             the system running on that UID.
                              </p>
                              <p>See also the <span class="guilabel">Add CellApp</span> and
                                             <span class="guilabel">Stop the World</span> buttons.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Add Bot App</span></p>
                              <p>Starts a Bot process on the local machine.</p>
                              <p>Similarly to the mechanism of the <span class="guilabel">Add
                                                CellApp</span> button, the new Bot process will join the rest
                                             of the system running on that UID.
                              </p>
                              <p>See also the <span class="guilabel">Add CellApp</span> and
                                             <span class="guilabel">Stop the World</span> buttons.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Space Viewer</span></p>
                              <p>Launches the Space Viewer tool. For more details, see <a href="ch03.html#xref_Space_Viewer" title="3.4.2.&nbsp;Space Viewer">Space Viewer</a>.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">100 More Guards</span></p>
                              <p><em class="emphasis">This button is specific to FantasyDemo example
                                                world.</em></p>
                              <p>Adds 100 NPCs to the world.</p>
                              <p>These are very simple simulated players driven by AI server
                                             scripts to act like guards.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Remove 100 Guards</span></p>
                              <p><em class="emphasis">This button is specific to FantasyDemo example
                                                world.</em></p>
                              <p>Removes 100 of the entities added by the <span class="guilabel">100 More
                                                Guards</span> button.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Telnet to CellApp</span></p>
                              <p>Opens a terminal window with a prompt to Python on the
                                             CellApp's port.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Telnet to BaseApp</span></p>
                              <p>Opens a terminal window with a prompt to Python on the
                                             BaseApp's port.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Start Storm</span></p>
                              <p><em class="emphasis">This button is specific to FantasyDemo example
                                                world.</em></p>
                              <p>Starts a thunderstorm in the world.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">Stop Storm</span></p>
                              <p><em class="emphasis">This button is specific to FantasyDemo example
                                                world.</em></p>
                              <p>Stops the thunderstorm in the world.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">Close Terms</span></p>
                              <p>Closes all terminal windows associated with running the
                                             world.
                              </p>
                              <p>It is used in conjunction with the <span class="guilabel">Stop the
                                                World</span> button, which does not close the
                                             terminals.
                              </p>
                              <p>See also the <span class="guilabel">Stop the World</span>
                                             button.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Stop the World</span></p>
                              <p>Stops all components of the running BigWorld server started
                                             by the following buttons:
                              </p>
                              <div class="itemizedlist">
                                 <ul type="circle">
                                    <li>
                                       <p>Start single-machine world</p>
                                    </li>
                                    <li>
                                       <p>Add CellApp</p>
                                    </li>
                                    <li>
                                       <p>Add BaseApp</p>
                                    </li>
                                 </ul>
                              </div>
                              <p>It does not stop BWMachined, which should be running all the
                                             time, nor tools such as the watcher process or GUI apps (Space
                                             Viewer, General Meter, etc...).
                              </p>
                              <p>The terminals are left open so that final output from the
                                             components can be examined.
                              </p>
                              <p>The <span class="guilabel">Close Terms</span> button closes the
                                             terminal windows associated with the world.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e7515"></a>3.4.1.2.&nbsp;Adding Buttons to BWPanel
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>When launched, BWPanel reads all files with extension
                                <span class="literal">.but</span> in its folder. These files are shell scripts,
                                each defining a single button.
                     </p>
                     <p>The code fragment below illustrates the implementation of the
                                <span class="guilabel">Display Details</span> button by the
                                <span class="literal">View_Info.but</span> file:
                     </p><pre class="programlisting">#!/bin/sh

#BWPANEL 2.5 'Display Details'

# start the cell up in a terminal. 
$MF_ROOT/bigworld/tools/myscript.sh</pre><p><span class="citetitle">Example <span class="literal">View_Info.but</span> file &#8212;
                                   Implementation of the <em class="emphasis">Display Details</em>
                                   button</span></p>
                     <p>As displayed in the example code above, the button definition
                                file has the sections below:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis">Code interpreter</em></p>
                              <p>Program to use to run the script</p>
                           </li>
                           <li>
                              <p><em class="emphasis">Display information</em></p>
                              <p>Optional display information. The parameters are described
                                             in the list below:
                              </p>
                              <div class="itemizedlist">
                                 <ul type="circle">
                                    <li>
                                       <p><em class="emphasis">Button order</em></p>
                                       <p>Floating-point specifying the order in which button is
                                                          to be displayed.
                                       </p>
                                       <p>Button will not be displayed if value specified is not
                                                          unique.
                                       </p>
                                    </li>
                                    <li>
                                       <p><em class="emphasis">Button label</em></p>
                                       <p>Label to be displayed for the button.</p>
                                       <p>If you choose to not specify it, then it will be derived
                                                          from the file name (underscores are converted to spaces, and
                                                          the extension is dropped).
                                       </p>
                                       <p>In the example above, if <span class="literal">Display
                                                             Details</span> was not specified, then the button would
                                                          have been labelled <span class="literal">View Info</span> (the file name
                                                          is <span class="literal">View_Info.but</span>)
                                       </p>
                                    </li>
                                 </ul>
                              </div>
                           </li>
                           <li>
                              <p><em class="emphasis">Code</em></p>
                              <p>Code to be executed when button is clicked &#8212; the syntax is
                                             specific to whatever interpreter was chosen.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e7591"></a>3.4.1.3.&nbsp;Command-Line Options
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Located under the
                                <span class="literal">bigworld/tools/server/bwpanel</span> folder, BWPanel can
                                be called via command line with the following syntax:
                     </p><pre class="programlisting">bwpanel [-display display]</pre><p>The options for bwpanel are interpreted by Tcl/Tk's wish
                                command, and are described in the list below:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">-display
                                                   display</span></em></p>
                              <p>Specifies the display (and screen) on which to display
                                             window.
                              </p>
                              <p>The <span class="literal">display</span> argument specifies the X
                                             window on which to display instead of the one specified in the
                                             <span class="literal">DISPLAY</span> environment variable.
                              </p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
               <div class="sect2" lang="en">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="xref_Space_Viewer"></a>3.4.2.&nbsp;Space Viewer
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>Space Viewer (located in bigworld/tools/server/space_viewer) logs
                           and displays a dynamic graphic representation of the distribution of
                           cells on a space, and the entities (player characters, NPCs, and other
                           objects) on those cells.
                  </p>
                  <p>Space Viewer uses a client/server architecture, and is therefore
                           composed of two distinct parts, which may be used simultaneously or
                           separately. The "server" side either communicates with the BigWorld
                           server to collect and log information about a space, or reads a
                           previously written log. The "client" side connects to the server process
                           and displays the space information it provides.
                  </p>
                  <p>Since the two halves of Space Viewer communicate via TCP, they can
                           be run on different machines, although obviously the client is most
                           responsive when both parts are run on the same machine.
                  </p>
                  <p>The most common use of Space Viewer is generally to monitor the
                           state of a live BigWorld server, and as such, both the client and server
                           components are run in tandem. Other times, when space data needs to be
                           collected over long periods of time (for example, during testing), the
                           server part of Space Viewer (svlogger.py) will be run on its own, with
                           the option to connect a client window to it at any time to examine the
                           current state or look back through the log recorded thus far.
                  </p>
                  <p>In the most common case of merely wanting to monitor an active
                           server, and not being interested in extended period logging, Space
                           Viewer will be started by simply running space_viewer.py. Its main
                           window is displayed below:
                  </p>
                  <div class="informalfigure">
                     <div class="mediaobject"><img src="images/space_viewer_window.png"><span class="caption">
                           <p>Space Viewer window</p></span></div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e7639"></a>3.4.2.1.&nbsp;Selecting Spaces to View
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>SpaceViewer displays a list of user IDs that are currently
                                running BigWorld server clusters. If you do not see your UID listed in
                                Space Viewer, then select <em class="emphasis">File <span class="symbol">&#8594;</span> Refresh</em> menu item &#8212; this is necessary
                                because the list is not automatically refreshed.
                     </p>
                     <p>In the example above, users 502, 573 and 589 are running server
                                clusters.
                     </p>
                     <p>Clicking the icon to the left of user name expands the list to
                                display all spaces available for that server instance.
                     </p>
                     <p>In the example above, the server cluster run by user 502 has
                                spaces 2, 5 and 9. To see the map of a space, double click its entry
                                on the list. This will start an svlogger process logging data from the
                                selected space, as well as a client window that is connected to it.
                                Closing the client window will cause the logger to terminate and
                                exit.
                     </p>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e7656"></a>3.4.2.2.&nbsp;Menu Items
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>The list below describes the menu item available in the Space
                                window:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><span class="guilabel">File <span class="symbol">&#8594;</span> Close window and terminate
                                                Logger</span></p>
                              <p>Closes the Space window and terminates the Logger. This item
                                             does not quit the Space Viewer.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">File <span class="symbol">&#8594;</span> Close window</span></p>
                              <p>Closes the Space window. This item does not quit the Space
                                             Viewer.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Update entities</span></p>
                              <p>Specifies that entities' position is determined by polling
                                             the currently selected cell.
                              </p>
                              <p><em class="emphasis">Note</em>: It is possible to
                                             view entities from only one cell at a time.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Set Cell App Update Frequency</span></p>
                              <p>Opens the Change Display Update Interval dialog box, where
                                             you can change how often entity positions are queried from the
                                             cell.
                              </p>
                              <p>Smaller values for this settings cause greater load on the
                                             cell. In large systems, it is recommended to increase the delay
                                             (<em class="emphasis">e.g.</em>, to 3 seconds)
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Set Cell App Manager Update Frequency</span></p>
                              <p>Opens the Change Display Update Interval dialog box, where
                                             you can change how often the cell boundaries are queried from the
                                             CellAppMgr and redrawn.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Zoom in</span></p>
                              <p>Displays a smaller area of the space.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Zoom out</span></p>
                              <p>Displays a bigger area of the space.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Zoom to space bounds</span></p>
                              <p>Automatically zooms to the extents of the current
                                             space.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Image overlay <span class="symbol">&#8594;</span> Display image
                                                overlay</span></p>
                              <p>Opens the Choose An Image To Overlay dialog box, where you
                                             can choose the file with the image to superimpose onto the
                                             display.
                              </p>
                              <p>The image would typically be a screenshot from inside
                                             WorldEditor.
                              </p>
                              <p>Examples are provided in
                                             fantasydemo/res/server/space_images.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Image overlay <span class="symbol">&#8594;</span> Remove image
                                                overlay</span></p>
                              <p>Disables the display of an image overlay.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Image overlay <span class="symbol">&#8594;</span> Recent image
                                                overlays</span></p>
                              <p>List of most recent image overlays.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Graph overlay <span class="symbol">&#8594;</span> Display graph
                                                overlay</span></p>
                              <p>Opens the Choose A Graph File dialog box, where you can
                                             choose the file with the graph topology to superimpose onto the
                                             display.
                              </p>
                              <p>File should have the XML format accepted by the standard
                                             bots Patrol movement controller. For more details, see <a href="ch08.html#xref_Controlling_Movement" title="8.4.&nbsp;Controlling Movement">Controlling Movement</a>.
                              </p>
                              <p>The user will be prompted to specify the factor by which the
                                             specified graph should be resized.
                              </p>
                              <p>This feature is useful when you are running tests with
                                             bots.
                              </p>
                              <p>Sample graph topologies can be found in
                                             fantasydemo/res/server/ bots.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Graph overlay <span class="symbol">&#8594;</span> Remove graph
                                                overlay</span></p>
                              <p>Disables the display of a graph overlay.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">View <span class="symbol">&#8594;</span> Graph overlay <span class="symbol">&#8594;</span> Recent graph
                                                overlays</span></p>
                              <p>List of most recent graph overlays.</p>
                           </li>
                           <li>
                              <p><em class="emphasis">Colour <span class="symbol">&#8594;</span> CellApp ID</em>,
                                             <em class="emphasis">Colour <span class="symbol">&#8594;</span> IP address</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Cell load</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Partition load</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Entity bounds</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Space boundary</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Grid</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Ghost entity</em>, <em class="emphasis">Colour <span class="symbol">&#8594;</span> Cell boundary</em></p>
                              <p>Lets you select a colour to draw the specified element
                                             in.
                              </p>
                              <p>A sub-menu displays the colours available for rendering the
                                             element.
                              </p>
                              <p>If you do not want the item to be displayed, then select
                                             <span class="literal">None</span>.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Colour <span class="symbol">&#8594;</span> Relative colouring</span></p>
                              <p>Colours the CellApp load information according to its
                                             load.
                              </p>
                              <p>Colour will range from aqua blue (light loaded) to full red
                                             (heavy loaded).
                              </p>
                              <div class="informalfigure">
                                 <div class="mediaobject"><img src="images/light_load_cellapp_and_heave_load_cellapp.png"><span class="caption">
                                       <p>Light-load CellApp and Heavy-load
                                                          CellApp
                                       </p></span></div>
                              </div>
                           </li>
                           <li>
                              <p><span class="guilabel">Entity size <span class="symbol">&#8594;</span> 25%</span>, <span class="guilabel">Entity
                                                size <span class="symbol">&#8594;</span> 50%</span>, <span class="guilabel">Entity size <span class="symbol">&#8594;</span> 75%</span>,
                                             <span class="guilabel">Entity size <span class="symbol">&#8594;</span> 100%</span>, <span class="guilabel">Entity
                                                size <span class="symbol">&#8594;</span> 150%</span>, <span class="guilabel">Entity size <span class="symbol">&#8594;</span> Custom
                                                scale...</span></p>
                              <p>Sets the size of the entity symbol to the specified
                                             scale.
                              </p>
                              <p>If the <span class="guilabel">Custom Scale</span> menu item is
                                             selected, then a dialog will open, letting you specify a value
                                             ranging from 1 through 1,000.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Util <span class="symbol">&#8594;</span> Retire selected cell</span></p>
                              <p><em class="emphasis">Item available mainly for debugging
                                                purposes.</em></p>
                              <p>Removes the selected cell from the system.</p>
                              <p>Note that CellAppMgr will probably add the cell back when it
                                             performs auto load balancing.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Util <span class="symbol">&#8594;</span> Stop selected CellApp</span></p>
                              <p><em class="emphasis">Item available mainly for debugging
                                                purposes.</em></p>
                              <p>Stops the selected CellApp process.</p>
                           </li>
                           <li>
                              <p><span class="guilabel">Visible entities <span class="symbol">&#8594;</span> Show all</span></p>
                              <p>This will set all entity types in the selected cell as
                                             visible, giving a complete view of all entities.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Warp <span class="symbol">&#8594;</span> Warp to time</span></p>
                              <p>Opens the <span class="guilabel">Warp</span> dialog box, where you
                                             can specify the date and time for which you want to display space
                                             data.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Warp <span class="symbol">&#8594;</span> Warp to log event</span></p>
                              <p>Opens the <span class="guilabel">Choose A Timestamped Log</span>
                                             dialog box, where you can specify the log file containing the
                                             space data that you want to display.
                              </p>
                           </li>
                           <li>
                              <p><span class="guilabel">Help <span class="symbol">&#8594;</span> Help</span></p>
                              <p>Displays help for Space window.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e8023"></a>3.4.2.3.&nbsp;Viewing Spaces
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Multiple spaces can be viewed simultaneously, each in their own
                                window. To view a space, double-click its entry on the space list
                                displayed in Space Viewer.
                     </p>
                     <p>The example below shows a space being handled by five cells. It
                                is important to note that in the selected cell only the entity types
                                selected in the <em class="emphasis">Visible Entities</em> menu
                                item will be displayed. All ghost entities will be drawn regardless of
                                the entities selected in this menu.
                     </p>
                     <p>Initially, no cell on the space will be selected for viewing.
                                The cell boundaries and the cell information (IP address, load,
                                etc...) will always be shown, but to see the entities on a particular
                                cell (as with cell #1 in the screenshot below) it must be selected
                                with a single click
                     </p>
                     <div class="informalfigure">
                        <div class="mediaobject"><img src="images/space_window.png"><span class="caption">
                              <p>Space window</p></span></div>
                     </div>
                     <p>The list below describe some of the components of the Space
                                window:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis">CellApp load</em></p>
                              <p>CPU load calculated by the CellApp itself.</p>
                           </li>
                           <li>
                              <p><em class="emphasis">Selected cell's real
                                                entity</em></p>
                              <p>The dots are coloured according to their type. For more
                                             details see <a href="ch03.html#xref_Customising_Entity_And_Display_Colours" title="3.4.2.4.&nbsp;Customising Entity and Display Colours">Customising Entity and Display Colours</a>.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Scale information</em></p>
                              <p>Indicates the size of the viewed area (space and cells). In
                                             the example above, the space is slightly over 3km x 4km.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Cell boundary</em></p>
                              <p>If the displayed space contains more than one cell, then the
                                             geographic tessellation will be indicated.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Cursor position</em></p>
                              <p>Displays the current position of the cursor (x,z) in
                                             metres.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Entities information</em></p>
                              <p>Displays the number of real and ghost entities on selected
                                             cell.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>To change the visualisation of the space via keyboard or mouse,
                                you have the following options:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis">Select a cell</em></p>
                              <p>Click anywhere in a cell to make it active. Click on the
                                             cell again to deselect it.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Move the view</em></p>
                              <p>Click within the display and drag the mouse to move the cell
                                             display.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis">Zoom in/out</em></p>
                              <p>To zoom in and out of the display, use the Page Up and Page
                                             Down keys, or the mouse wheel.
                              </p>
                              <p>You can also use the middle mouse button to draw a
                                             rectangle, thus selecting the new area to view. As you zoom, scale
                                             information is updated to reflect the changes. If you get lost,
                                             restart the visualisation by selecting the <em class="emphasis">View&#61664;Zoom To Space Bounds</em> menu item, or by
                                             pressing <span class="literal">Ctrl</span>+<span class="literal">Home</span>.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>You can also seek the space view forwards or backwards in time
                                using the keyboard. You can seek backwards as far as the time the
                                logger was started, and if you seek forward to the current time, then
                                the window will start updating in real time again.
                     </p>
                     <p>The list below displays the keyboard shortcuts for controlling
                                playback:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">LEFT
                                                   ARROW</span></em></p>
                              <p>Moves the playback 1 second backwards.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">RIGHT
                                                   ARROW</span></em></p>
                              <p>Moves the playback 1 second forward.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">UP
                                                   ARROW</span></em></p>
                              <p>Moves the playback 60 seconds backwards.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">DOWN
                                                   ARROW</span></em></p>
                              <p>Moves the playback 60 seconds forward.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">Home</span></em></p>
                              <p>Moves the playback to the beginning of the log.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">END</span></em></p>
                              <p>Moves the playback to the end of the log.</p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">Ctrl+L</span></em></p>
                              <p>Prompts the user to select a command log file &#8212; this can be
                                             any file in which each line contains date/time string like
                                             '<span class="literal">Thu Nov 17 17:45:45 2005</span>'..
                              </p>
                              <p>Once the file is selected, the script will display all
                                             logged events contained in the log file, and prompt the user to
                                             select one.
                              </p>
                              <p>Once event is selected, playback time will be warped to the
                                             time of selected event.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">Ctrl+W</span></em></p>
                              <p>Prompts the user to enter a time to warp the playback
                                             to.
                              </p>
                           </li>
                        </ul>
                     </div>
                     <p>In order to facilitate identification of entities there is also
                                tool tip information for all non-ghosted entities. This information
                                will appear if the cursor hovers over an entity marker for a
                                sufficiently long time.
                     </p>
                     <div class="informalfigure">
                        <div class="mediaobject"><img src="images/entity_tooltip.png"><span class="caption">
                              <p>Entity tooltip</p></span></div>
                     </div>
                     <p>The entity type name is retrieved from file
                                <span class="literal">&lt;res&gt;/scripts/entities.xml</span>, and corresponds
                                to the IDs in the menu Visible Entities described above.
                     </p>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="xref_Customising_Entity_And_Display_Colours"></a>3.4.2.4.&nbsp;Customising Entity and Display Colours
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Space Viewer allows you to customise the colours to be used when
                                drawing the elements in the Space window. But this customisation is
                                not saved, and will not be in effect the next time the application is
                                started.
                     </p>
                     <p>However, it is possible to permanently change the colours by
                                customising a Python file.
                     </p>
                     <p>Entities in the current cell are displayed with a coloured dot.
                                The colour can be customised in the local file style.py. The simplest
                                way is to update the dictionary colours (which contains RGB colour
                                definitions for each entity type).
                     </p>
                     <p>The code fragment below illustrates the definition of permanent
                                entity colours:
                     </p><pre class="programlisting"># specify colour for entity Types.
entityColours = {
0: ((111, 114, 247), 2.0), <img src="images/rgb_111_114_247.png">
1: ((244, 111, 247), 1.0), <img src="images/rgb_244_111_247.png">
2: ((124, 247, 111), 1.0), <img src="images/rgb_124_247_111.png">
3: ((114, 241, 244), 1.0), <img src="images/rgb_114_241_244.png">
4: ((21,  168, 179), 1.0)  <img src="images/rgb_21_168_179.png">
}</pre><p><span class="citetitle">Example local file
                                   <span class="literal">style.py</span></span></p>
                     <p>The entity's number is defined by its order of appearance in
                                file
                                <span class="literal"><em class="replaceable"><code>&lt;res&gt;</code></em>/scripts/entity.xml</span>.
                                Entities which ID is not defined in the dictionary are coloured with
                                RGB (255,192,192). <span class="inlinemediaobject"><img src="images/rgb_255_192_192.png"></span></p>
                     <p>So assuming the following file
                                <span class="literal"><em class="replaceable"><code>&lt;res&gt;</code></em>/scripts/entities.xml</span>,
                                these will be the entities' display colours:
                     </p><pre class="programlisting">&lt;root&gt;
  &lt;Knight/&gt;    <img src="images/rgb_111_114_247.png">
  &lt;Warlock/&gt;   <img src="images/rgb_244_111_247.png">
  &lt;Merchant/&gt;  <img src="images/rgb_124_247_111.png">
  &lt;Guard/&gt;     <img src="images/rgb_114_241_244.png">
  &lt;Ripper/&gt;    <img src="images/rgb_21_168_179.png">
  &lt;Thief/&gt;     <img src="images/rgb_255_192_192.png">
  &lt;Foreigner/&gt; <img src="images/rgb_255_192_192.png">
&lt;/root&gt;</pre><p><span class="citetitle">Example file
                                   <span class="literal"><em class="replaceable"><code>&lt;res&gt;</code></em>/scripts/entities.xml</span>
                                   and their display colours in Space Viewer</span></p>
                     <p>You can also replace the entire function
                                getColourForEntity(entityID, entityTypeID), using your own algorithm
                                to colour the entities.
                     </p>
                     <p>All other colours are defined by the dictionary colourOptions.
                                They can be changed to any of the colours defined by the colours
                                array.
                     </p>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e8294"></a>3.4.2.5.&nbsp;Running the Client and Server Parts of Space Viewer
                                         Separately
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>As described at the start of this section, Space Viewer's two
                                halves can be run separately as needed. This would usually take the
                                form of running svlogger over an extended period of time, connecting
                                clients to it to monitor live state as necessary, then eventually
                                shutting down the logger. Later, the logger can be connected to its
                                previously recorded log (instead of a live server) and client windows
                                can be attached to it to replay the log data.
                     </p>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="d0e8299"></a>3.4.2.5.1.&nbsp;<span class="literal">svlogger.py</span></h5>
                              </div>
                           </div>
                        </div>
                        <p>The svlogger script provides log writing and reading for Space
                                     Viewer. In writing mode, it is responsible for gathering the space
                                     data from the actual running BigWorld server (which it does by
                                     polling the CellAppMgr every second or so). In reading mode, it
                                     opens a previously recorded log for replay via any client
                                     connections.
                        </p>
                        <p>The basic options for <span class="literal">svlogger</span>
                                     include:
                        </p>
                        <div class="itemizedlist">
                           <ul type="disc">
                              <li>
                                 <p><em class="emphasis"><span class="literal">-l
                                                        <em class="replaceable"><code>&lt;listenip:listenport&gt;</code></em></span></em></p>
                                 <p>Specifies the port that svlogger will listen for
                                                  connections from svreplay. If not specified, any available port
                                                  will be used.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-o
                                                        <em class="replaceable"><code>&lt;logdir&gt;</code></em></span></em></p>
                                 <p>Specifies the directory to write the data log to. Default
                                                  is <span class="literal">/tmp/svlog</span>.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-p
                                                        <em class="replaceable"><code>&lt;prefix&gt;</code></em></span></em></p>
                                 <p>Specifies the prefix for the log files. Default is
                                                  <span class="literal">svlog</span>.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-s
                                                        <em class="replaceable"><code>&lt;spaceid&gt;</code></em></span></em></p>
                                 <p>Specifies the space to log data for. Default is the
                                                  server&#8217;s default space.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-u
                                                        <em class="replaceable"><code>&lt;uid&gt;</code></em></span></em></p>
                                 <p>Specifies the user to log data for. Default is current
                                                  user's ID.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-k |
                                                        --keepalive</span></em></p>
                                 <p>Specifies that the logger should terminate once the last
                                                  client connection is terminated. Useful when only interested in
                                                  monitoring a live server, and not interested in logs.
                                 </p>
                              </li>
                              <li>
                                 <p><em class="emphasis"><span class="literal">-r
                                                        <em class="replaceable"><code>&lt;logpath&gt;</code></em></span></em></p>
                                 <p>Activates replay mode for the log stored at the given
                                                  path.
                                 </p>
                                 <p>The path is the concatenation of the
                                                  <span class="literal"><em class="replaceable"><code>&lt;logdir&gt;</code></em></span> and
                                                  <span class="literal"><em class="replaceable"><code>&lt;prefix&gt;</code></em></span>
                                                  specified for <span class="literal">-o</span> and <span class="literal">-p</span>
                                                  switches, respectively. For example, if you want to replay the
                                                  default log location, you would specify
                                                  <span class="literal">/tmp/svlog/svlog</span> as the
                                                  <span class="literal"><em class="replaceable"><code>&lt;logpath&gt;</code></em></span>.
                                 </p>
                                 <p>This option can also be passed to
                                                  <span class="literal">space_viewer.py</span> to open a log with
                                                  <span class="literal">svlogger</span> and automatically connect a viewer
                                                  window to it.
                                 </p>
                              </li>
                           </ul>
                        </div>
                     </div>
                     <div class="sect4" lang="en">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h5 class="title"><a name="xref_Connecting_A_Client_Window_To_svlogger"></a>3.4.2.5.2.&nbsp;Connecting a Client Window to svlogger
                                 </h5>
                              </div>
                           </div>
                        </div>
                        <p>If you have started <span class="literal">svlogger</span> manually, then
                                     you will also need to manually connect client windows to the logger
                                     if you wish to view its space data. This is easily done by running
                                     <span class="literal">space_viewer.py</span> with the <span class="literal">-c
                                        <em class="replaceable"><code>&lt;ip:port&gt;</code></em></span> option. The
                                     address passed to this option should be the address that svlogger is
                                     listening for connections on (which is displayed in the initial
                                     output from svlogger after it starts up).
                        </p>
                     </div>
                  </div>
                  <div class="sect3" lang="en">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title"><a name="d0e8425"></a>3.4.2.6.&nbsp;Command-Line Options
                              </h4>
                           </div>
                        </div>
                     </div>
                     <p>Located under folder
                                <span class="literal">bigworld/tools/server/space_viewer</span>,
                                <span class="literal">space_viewer.py</span> can be called via command line with
                                the following syntax:
                     </p><pre class="programlisting">space_viewer.py [{-u |--uid=}&lt;user_id&gt;]
                [{-s |--space=}&lt;space_id&gt;]
                [{-c |--connect=}&lt;ip:port&gt;]
                [{-r |--replay=}&lt;log_prefix&gt;]
                [{-d |--dump-db=}&lt;log_db&gt;]
                [--autoselect]
                [-h|--help]</pre><p>The options for <span class="literal">space_viewer.py</span> are
                                interpreted by Tcl/Tk's wish command, and are described in the list
                                below:
                     </p>
                     <div class="itemizedlist">
                        <ul type="disc">
                           <li>
                              <p><em class="emphasis"><span class="literal">{-u |--uid=}
                                                   <em class="replaceable"><code>&lt;user_id&gt;</code></em></span></em></p>
                              <p>User for whose space is to be viewed. If this option is
                                             used, then <span class="literal">-s|--space</span> must also be
                                             specified.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">{-s |--space=}
                                                   <em class="replaceable"><code>&lt;space_id&gt;</code></em></span></em></p>
                              <p>Space to view. If option <span class="literal">-u|--uid</span> is not
                                             specified, then the viewed <span class="literal">space_id</span> will be
                                             that of current user.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">{-c |--connect=}
                                                   <em class="replaceable"><code>&lt;ip:port&gt;</code></em></span></em></p>
                              <p>Address on which to connect to
                                             <span class="literal">svlogger.py</span>. For details, see <a href="ch03.html#xref_Connecting_A_Client_Window_To_svlogger" title="3.4.2.5.2.&nbsp;Connecting a Client Window to svlogger">Connecting a Client Window to svlogger</a>. If this
                                             option is specified, the <code class="option">-u</code> option must not be
                                             specified.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">{-r |--replay=}
                                                   <em class="replaceable"><code>&lt;log_prefix&gt;</code></em></span></em></p>
                              <p>Opens log with <span class="literal">svlogger</span> and automatically
                                             connects a viewer window to it.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">{-d |--dump-db=}
                                                   <em class="replaceable"><code>&lt;log_db&gt;</code></em></span></em></p>
                              <p>Displays all values from l<span class="literal">og_db</span>.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">--autoselect</span></em></p>
                              <p>On startup, automatically selects a cell on specified space.
                                             If this option is used, then <span class="literal">-s|--space</span> must
                                             also be specified.
                              </p>
                           </li>
                           <li>
                              <p><em class="emphasis"><span class="literal">-h|--help</span></em></p>
                              <p>Displays online help.</p>
                           </li>
                        </ul>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="navfooter">
            <hr class="navheaderline">
            <table width="95%" align="center" summary="Navigation footer">
               <tr>
                  <td width="38%" align="left"><a accesskey="p" href="ch02.html">Prev</a>&nbsp;
                  </td>
                  <td width="20%" align="center">&nbsp;</td>
                  <td width="37%" align="right">&nbsp;<a accesskey="n" href="ch04.html">Next</a></td>
               </tr>
               <tr>
                  <td width="40%" align="left" valign="top">Chapter&nbsp;2.&nbsp;Server Configuration with <span class="literal">bw.xml</span>&nbsp;
                  </td>
                  <td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
                  <td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;4.&nbsp;Watcher (Web Interface)</td>
               </tr>
               <tr>
                  <td colspan="3">Copyright 1999-2008 BigWorld Pty. Ltd. All rights reserved. Proprietary commercial in confidence.
                     		   
                  </td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>