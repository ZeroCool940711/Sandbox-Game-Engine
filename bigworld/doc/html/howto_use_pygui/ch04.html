<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>Chapter&nbsp;4.&nbsp;Constructing an Interface</title>
      <link rel="stylesheet" type="text/css" href="../css/bigworld.css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
      <link rel="home" href="index.html" title="Using PyGUI">
      <link rel="up" href="index.html" title="Using PyGUI">
      <link rel="prev" href="ch03.html" title="Chapter&nbsp;3.&nbsp;Integration">
      <link rel="next" href="ch05.html" title="Chapter&nbsp;5.&nbsp;Component Script Reference">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div id="bigworld-header"><img src="http://try.bigworldtech.com/bigworld/image.php?img=bigworld_logo.gif&amp;svn=$HeadURL: http://patchsvn/svn/evaluation/official/IndiePackage/2.1/current/bigworld/doc/html/howto_use_pygui/ch04.html $" alt="bw logo"></div>
      <div id="content">
         <div class="navheader">
            <table width="95%" align="center" summary="Navigation header">
               <tr>
                  <th colspan="3" align="center">Chapter&nbsp;4.&nbsp;Constructing an Interface</th>
               </tr>
               <tr>
                  <td width="20%" align="left"><a accesskey="p" href="ch03.html">Prev</a>&nbsp;
                  </td>
                  <th width="55%" align="center">&nbsp;</th>
                  <td width="20%" align="right">&nbsp;<a accesskey="n" href="ch05.html">Next</a></td>
               </tr>
            </table>
            <hr class="navheaderline">
         </div>
         <div class="chapter" title="Chapter&nbsp;4.&nbsp;Constructing an Interface">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="xref_Constructing_An_Interface"></a>Chapter&nbsp;4.&nbsp;Constructing an Interface
                     </h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Table of Contents</b></p>
               <dl>
                  <dt><span class="section"><a href="ch04.html#d0e543">4.1. Window script</a></span></dt>
                  <dt><span class="section"><a href="ch04.html#d0e567">4.2. Window component</a></span></dt>
                  <dt><span class="section"><a href="ch04.html#d0e581">4.3. Adding components to the window</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="ch04.html#d0e594">4.3.1. Attaching existing visual states</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="section"><a href="ch04.html#d0e604">4.4. Handling events</a></span></dt>
                  <dt><span class="section"><a href="ch04.html#d0e637">4.5. Loading and displaying the window</a></span></dt>
                  <dt><span class="section"><a href="ch04.html#d0e644">4.6. Tweaking existing windows</a></span></dt>
               </dl>
            </div>
            <p>This section outlines the typical process of creating a new user
                 interface with PyGUI. An individual user interface will usually be a window
                 that encapsulates some part of the game, for example the chat window or the
                 graphics settings window.
            </p>
            <div class="section" title="4.1.&nbsp;Window script">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e543"></a>4.1.&nbsp;Window script
                        </h2>
                     </div>
                  </div>
               </div>
               <p>The first step in creating a new window is to derive a new class
                      which will be used to handle events generated by the components on the
                      window. A minimal window that has no logic would look like this:
               </p><pre class="programlisting">from Helpers.PyGUI import Window

class MyFirstWindow( Window ):
    factoryString = "GameGUI.MyFirstWindow"

    def __init__( self, component ):
        Window.__init__( self, component )</pre><p>The class should include a factory string class property, which is
                      used by the engine to know how to re-attach the class when deserialising
                      from a .gui file. Note the <code class="code">GameGUI</code> module name here is just
                      for illustrative purposes - this is a module created by you and is
                      specific to your game (for example FantasyDemo has a module called
                      <code class="code">FDGUI</code>).
               </p>
               <div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Tip</h3>
                  <p>To make a Window draggable (rather than static), derive from
                           <code class="code">DraggableWindow</code> rather than <code class="code">Window</code>.
                  </p>
               </div>
            </div>
            <div class="section" title="4.2.&nbsp;Window component">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e567"></a>4.2.&nbsp;Window component
                        </h2>
                     </div>
                  </div>
               </div>
               <p>Once there is a script to attach to the window component, it can be
                      created at the interactive Python console in the client.
               </p><pre class="programlisting">&gt;&gt;&gt; wnd = GameGUI.MyFirstWindow.create( "gui/maps/window_background.tga" )
&gt;&gt;&gt; ... # setup properties like .width and .height as required for your window</pre><p>Once the appopriate properties have been set on the
                      <code class="code">WindowGUIComponent</code> as required, save it to a .gui
                      file.
               </p><pre class="programlisting">&gt;&gt;&gt; wnd.save( "gui/myfirstwindow.gui" )</pre></div>
            <div class="section" title="4.3.&nbsp;Adding components to the window">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e581"></a>4.3.&nbsp;Adding components to the window
                        </h2>
                     </div>
                  </div>
               </div>
               <p>Adding components to the window such as buttons and edit boxes is
                      simply a case of adding child GUI components and attaching the appropriate
                      script. Some scripts require a specific structure of multiple components
                      with the correct naming scheme to allow them to work (e.g. a slider
                      consists of a background component and a "thumb" slider component), so to
                      ease creation most component scripts provide helper "create" functions
                      which assemble the required components in the correct way.
               </p>
               <p>For example, the Button class has a static create method which
                      creates a parent component that acts as the background image and input
                      event handler, and a child text component for its label. As such, a Button
                      can be created with a single call:
               </p><pre class="programlisting">&gt;&gt;&gt; button = PyGUI.Button.create( "gui/maps/button-background.tga", "Button Text!" )
&gt;&gt;&gt; wnd.addChild( button, "someButtonName" )
&gt;&gt;&gt; button.position.x = 0.2
&gt;&gt;&gt; button.position.y = -0.1
&gt;&gt;&gt; ...
&gt;&gt;&gt; wnd.save( "gui/myfirstwindow.gui" )</pre><p>See <a class="xref" href="ch05.html" title="Chapter&nbsp;5.&nbsp;Component Script Reference"><i>Component Script Reference</i></a> for each
                      script to see how they can be created.
               </p>
               <div class="section" title="4.3.1.&nbsp;Attaching existing visual states">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title"><a name="d0e594"></a>4.3.1.&nbsp;Attaching existing visual states
                           </h3>
                        </div>
                     </div>
                  </div>
                  <p>To attach a pre-existing external visual state XML definition to a
                           component, use the <code class="code">loadVisualStates</code> method on the component
                           script. For example,
                  </p><pre class="programlisting">&gt;&gt;&gt; button.script.loadVisualStates( "gui/visual_states/ingame_menu_button.xml" )</pre></div>
            </div>
            <div class="section" title="4.4.&nbsp;Handling events">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e604"></a>4.4.&nbsp;Handling events
                        </h2>
                     </div>
                  </div>
               </div>
               <p>Events generated by component scripts (e.g. button click, slider
                      movement) are handled by the window script. A Python decorator called
                      <code class="code">PyGUIEvent</code> is provided to make this as simple as
                      possible.
               </p>
               <p>The <code class="code">PyGUIEvent</code> decorator takes two arguments, the name
                      of the child component that generates the event and the name of the event
                      to handle. For example, the <code class="code">onClick</code> event for the button
                      created in the previous section can be handled:
               </p><pre class="programlisting">class MyFirstWindow( Window ):
    ...
    @PyGUI.PyGUIEvent( "someButtonName", "onClick" ):
    def theButtonGotClicked( self ):
        print "HELLO!"</pre><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Note</h3>
                  <p>Use dotted notation if the component that generates the
                           event is several children deep in the GUI hierarchy. For example, if the
                           button is contained within a sub-window named "buttonContainer", then
                           the decorator would be written as,
                  </p><pre class="programlisting">@PyGUI.PyGUIEvent( "buttonContainer.someButtonName", "onClick"</pre><p>This can be any number of children deep.</p>
               </div>
               <p><code class="code">PyGUIEvent</code> supports partial method parameter
                      completion, which can be put to effective use by stacking multiple
                      decorators onto the same method. A simple example of this would be if you
                      had multiple buttons on the window that perform similar operations:
               </p><pre class="programlisting">class MyFirstWindow( Window ):
    ...
    @PyGUI.PyGUIEvent( "helloButton1", "onClick", 1 ):
    @PyGUI.PyGUIEvent( "helloButton2", "onClick", 2 ):
    @PyGUI.PyGUIEvent( "helloButton3", "onClick", 3 ):
    def onHelloButtonClick( self, numTimes ):
        for x in range(numTimes):
            print "HELLO!"</pre><p>Any number of arguments and key word arguments can be pre-filled in
                      this way.
               </p>
            </div>
            <div class="section" title="4.5.&nbsp;Loading and displaying the window">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e637"></a>4.5.&nbsp;Loading and displaying the window
                        </h2>
                     </div>
                  </div>
               </div>
               <p>To display the window at run-time, load the window from disk and
                      then activate it. Keep in mind that since it can take some time to load
                      the .gui file and related resources (such as textures), it is better to
                      load it once on startup and keep initially hidden until required. For
                      example:
               </p><pre class="programlisting">...
# on GameGUI initialisation
self.myFirstWindow = GUI.load( "gui/myfirstwindow.gui" )

...
# somewhere else in a key event handler
if event.key == Keys.ESCAPE:
    self.myFirstWindow.script.active( True )</pre></div>
            <div class="section" title="4.6.&nbsp;Tweaking existing windows">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title" style="clear: both"><a name="d0e644"></a>4.6.&nbsp;Tweaking existing windows
                        </h2>
                     </div>
                  </div>
               </div>
               <p>There are two ways you can modify existing user interfaces.</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" type="disc">
                     <li class="listitem">
                        <p>Load the .gui file in the client, modify it on the Python
                                     console, then resave it. This is often the easiest method when
                                     making more extensive modifications.
                        </p>
                     </li>
                     <li class="listitem">
                        <p>Edit the .gui file in a text editor. This is good for small
                                     tweaks, such as moving the position of a component slightly.
                        </p>
                     </li>
                  </ul>
               </div>
            </div>
         </div>
         <div class="navfooter">
            <hr class="navheaderline">
            <table width="95%" align="center" summary="Navigation footer">
               <tr>
                  <td width="38%" align="left"><a accesskey="p" href="ch03.html">Prev</a>&nbsp;
                  </td>
                  <td width="20%" align="center">&nbsp;</td>
                  <td width="37%" align="right">&nbsp;<a accesskey="n" href="ch05.html">Next</a></td>
               </tr>
               <tr>
                  <td width="40%" align="left" valign="top">Chapter&nbsp;3.&nbsp;Integration&nbsp;</td>
                  <td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
                  <td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;5.&nbsp;Component Script Reference</td>
               </tr>
               <tr>
                  <td colspan="3">Copyright 1999-2012 BigWorld Pty. Ltd. All rights reserved. Proprietary commercial in confidence.
                     		   
                  </td>
               </tr>
            </table>
         </div>
      </div>
   </body>
</html>