                                                                                                  
//--------------------------------------------------------------------------------------------    
DEFINE_GUID(CLSID_DirectMusicBand,0x79ba9e00, 0xb6ee, 0x11d1, 0x86, 0xbe, 0x0, 0xc0, 0x4f, 0xbf, 0x8f, 0xef); 
DEFINE_GUID(CLSID_DirectMusicTempoTrack,0xd2ac2885, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicSeqTrack,0xd2ac2886, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicSysExTrack,0xd2ac2887, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicTimeSigTrack,0xd2ac2888, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicChordTrack,0xd2ac288b, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicCommandTrack,0xd2ac288c, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicStyleTrack,0xd2ac288d, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicMotifTrack,0xd2ac288e, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicSignPostTrack,0xf17e8672, 0xc3b4, 0x11d1, 0x87, 0xb, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicBandTrack,0xd2ac2894, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicChordMapTrack,0xd2ac2896, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicMuteTrack,0xd2ac2898, 0xb39b, 0x11d1, 0x87, 0x4, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xbd);
DEFINE_GUID(CLSID_DirectMusicScriptTrack,0x4108fa85, 0x3586, 0x11d3, 0x8b, 0xd7, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); /* {4108FA85-3586-11d3-8BD7-00600893B1B6} */
DEFINE_GUID(CLSID_DirectMusicMarkerTrack,0x55a8fd00, 0x4288, 0x11d3, 0x9b, 0xd1, 0x8a, 0xd, 0x61, 0xc8, 0x88, 0x35);
DEFINE_GUID(CLSID_DirectMusicSegmentTriggerTrack, 0xbae4d665, 0x4ea1, 0x11d3, 0x8b, 0xda, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); /* {BAE4D665-4EA1-11d3-8BDA-00600893B1B6} */
DEFINE_GUID(CLSID_DirectMusicLyricsTrack, 0x995c1cf5, 0x54ff, 0x11d3, 0x8b, 0xda, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); /* {995C1CF5-54FF-11d3-8BDA-00600893B1B6} */
DEFINE_GUID(CLSID_DirectMusicParamControlTrack, 0x4be0537b, 0x5c19, 0x11d3, 0x8b, 0xdc, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); /* {4BE0537B-5C19-11d3-8BDC-00600893B1B6} */
DEFINE_GUID(CLSID_DirectMusicMelodyFormulationTrack, 0xb0684266, 0xb57f, 0x11d2, 0x97, 0xf9, 0x0, 0xc0, 0x4f, 0xa3, 0x6e, 0x58);
DEFINE_GUID(CLSID_DirectMusicWaveTrack,0xeed36461, 0x9ea5, 0x11d3, 0x9b, 0xd1, 0x0, 0x80, 0xc7, 0x15, 0xa, 0x74);
DEFINE_GUID(CLSID_DirectMusicSynth,0x58C2B4D0,0x46E7,0x11D1,0x89,0xAC,0x00,0xA0,0xC9,0x05,0x41,0x29);
DEFINE_GUID(CLSID_AutDirectMusicPerformance,		0xa861c6e2, 0xfcfc, 0x11d2, 0x8b, 0xc9, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); // {A861C6E2-FCFC-11d2-8BC9-00600893B1B6}
DEFINE_GUID(CLSID_AutDirectMusicSegment,			0x4062c116, 0x0270, 0x11d3, 0x8b, 0xcb, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); // {4062C116-0270-11d3-8BCB-00600893B1B6}
DEFINE_GUID(CLSID_AutDirectMusicSong,				0xa16f1761, 0xb6d8, 0x42eb, 0x8d, 0x57, 0x4a, 0x44, 0xfe, 0xdd, 0x3b, 0xd2);// {A16F1761-B6D8-42eb-8D57-4A44FEDD3BD2}
DEFINE_GUID(CLSID_AutDirectMusicSegmentState,		0xebf2320a, 0x2502, 0x11d3, 0x8b, 0xd1, 0x0, 0x60, 0x8, 0x93, 0xb1, 0xb6); // {EBF2320A-2502-11d3-8BD1-00600893B1B6}
DEFINE_GUID(CLSID_AutDirectMusicAudioPathConfig,	0x1cebde3e, 0x6b91, 0x484a, 0xaf, 0x48, 0x5e, 0x4f, 0x4e, 0xd6, 0xb1, 0xe1);// {1CEBDE3E-6B91-484a-AF48-5E4F4ED6B1E1}
DEFINE_GUID(CLSID_AutDirectMusicAudioPath,			0x2c5f9b72, 0x7148, 0x4d97, 0xbf, 0xc9, 0x68, 0xa0, 0xe0, 0x76, 0xbe, 0xbd);// {2C5F9B72-7148-4d97-BFC9-68A0E076BEBD}

STDAPI DirectMusicChordTrackCreate( REFIID iid, void ** ppDMT );
STDAPI DirectMusicCommandTrackCreate( REFIID iid, void ** ppDMT );
STDAPI DirectMusicStyleTrackCreate( REFIID iid, void ** ppDMT );
STDAPI DirectMusicMelodyFormulationTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicMuteTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicChordMapTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicChordMapCreate(REFIID iid, void ** ppChordMap );
STDAPI DirectMusicSignPostTrackCreate(REFIID iid, void ** ppChordMap );
STDAPI DirectMusicTempoTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicTimeSigTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicMarkerTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicBandTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicPatternTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicMotifTrackCreate(REFIID iid, void ** ppDMT );
STDAPI DirectMusicWaveTrackCreate(REFIID iid, void ** ppDMT);
STDAPI DirectMusicSegmentCreate( REFIID iid, void ** ppDMSeg );
STDAPI DirectMusicTemplCreate(REFIID iid, void ** ppDMTempl );
STDAPI DirectMusicPerformanceCreate(REFIID iid, void ** ppDMP);
STDAPI DirectMusicBandCreate(REFIID iid, void ** ppBand);
STDAPI DirectMusicStyleCreate(REFIID iid, void ** ppStyle);
STDAPI DirectMusicSectionCreate(REFIID iid, void ** ppSection);
STDAPI DirectMusicAutAudioPathCreate(LPUNKNOWN pUnkOuter,REFIID iid, void ** ppAuto);
STDAPI DirectMusicAutAudioPathConfigCreate(LPUNKNOWN pUnkOuter,REFIID iid, void ** ppAuto);
STDAPI DirectMusicAutSongCreate(LPUNKNOWN pUnkOuter,REFIID iid, void ** ppAuto);
STDAPI DirectMusicAutPerformanceCreate(LPUNKNOWN pUnkOuter,REFIID iid, void ** ppAuto);
STDAPI DirectMusicAutSegmentCreate(LPUNKNOWN pUnkOuter,REFIID iid, void ** ppAuto);
STDAPI DirectMusicScriptCreate(REFIID iid, void ** ppScript);
STDAPI DirectMusicScriptTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicSongCreate(REFIID iid, void ** ppSong);
STDAPI DirectMusicAudioPathConfigCreate(REFIID iid, void ** ppPath);
STDAPI DirectMusicSeqTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicGraphCreate(REFIID iid, void ** ppGraph);
STDAPI DirectMusicSysexTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicTriggerTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicLyricsTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicParamsTrackCreate(REFIID iid, void ** ppTrack);
STDAPI DirectMusicSegStateCreate(REFIID iid, void ** ppSegState);
STDAPI DirectMusicComposerCreate(REFIID iid, void ** ppDMComp8 );
STDAPI DirectMusicCreate(REFIID iid, void ** ppDMC );
STDAPI DirectMusicCollectionCreate(REFIID iid, void ** ppDMC );
STDAPI DirectMusicSynthCreate(REFIID iid, void ** ppDMSynth );
STDAPI DirectSoundWaveCreate( REFIID iid, void ** ppDSW );
STDAPI DirectMusicContainerCreate( REFIID iid, void ** ppContainer );
STDAPI DirectMusicLoaderCreate( REFIID iid, void ** ppLoader );
STDAPI AutDirectMusicSegmentStateCreate(LPUNKNOWN pUnkOuter, REFIID iid, void ** ppLoader );
STDAPI DirectMusicMemStreamCreate( REFIID iid, void ** ppStream );
STDAPI DirectMusicStreamStreamCreate( REFIID iid, void ** ppStream );
STDAPI DirectMusicFileStreamCreate( REFIID iid, void ** ppStream );
                                                                                                  
                                                                                                  
HRESULT CALLBACK MyFactory(REFCLSID clsid,
                           LPUNKNOWN pUnkOuter,
                           REFIID iid,
                           LPVOID *ppvInterface)
{
   HRESULT hr = E_FAIL;
    if (clsid == CLSID_DirectMusicWaveTrack)
    {
        // Wave Track - plays one or more waves.
        hr = DirectMusicWaveTrackCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectSoundWave)
    {
        // Wave: represents the file version of a wave - required if wave files are used.
        hr = DirectSoundWaveCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicSegment)
    {
        // Segment - primary playback mechanism - always required.
        hr = DirectMusicSegmentCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicSynth)
    {
        // Synthesizer: controls the hardware synthesizer - always required.
        hr = DirectMusicSynthCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicCommandTrack)
    {
        // Groove Track - used to store groove levels for style playback.
        hr = DirectMusicCommandTrackCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicChordMapTrack)
    {
        // ChordMap Track - defines ChordMap to be used to compose a chord track.
        hr = DirectMusicChordMapTrackCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicChordTrack)
    {
        // Chord Track - used for style playback.
        hr = DirectMusicChordTrackCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicComposer)
    {
        // Composer: creates playback segments and autotransitions from chordmaps and template segments.
        hr = DirectMusicComposerCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicMemStream)
    {
        // Memory Stream - used to read content from memory.
        hr = DirectMusicMemStreamCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicStreamStream)
    {
        // Stream wrapper - used to read content from app supplied IStream.
        hr = DirectMusicStreamStreamCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicFileStream)
    {
        // File Stream - used to read content from disk.
        hr = DirectMusicFileStreamCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicCollection)
    {
        // DLS Collection: manages a DLS file - always required for MIDI + DLS.
        hr = DirectMusicCollectionCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicLoader)
    {
        // Loader: required to read files from disk and link objects. May be replaced by application.
        hr = DirectMusicLoaderCreate(iid,ppvInterface);
    }
    else if (clsid == CLSID_DirectMusicPerformance)
    {
        // Performance - segment playback framework, always required.
        hr = DirectMusicPerformanceCreate(iid,ppvInterface);
    }
    #ifndef AUDANALYZE_NODEBUG
    else                           
    {                              
        OutputDebugString("DirectMusic needs to allocate an object that your MyFactory() function doesn't support.  \n");
        OutputDebugString("Please locate the CLSID in the list above MyFactory(), or in dmusici.h, and make sure    \n");
        OutputDebugString("AudAnalyzer includes support for this CLSID when generating MyFactory(), by using        \n");
        OutputDebugString("a command-line parameter if necessary (see AudAnalyzer docs for more details.)           \n");
        CHAR szTemp[MAX_PATH] ={0};
        sprintf(szTemp,"Unknown CLSID: %08x-%04x-%04x-%02x%02x%02x%02x%02x%02x%02x%02x\n", clsid.Data1, clsid.Data2, clsid.Data3, clsid.Data4[0], clsid.Data4[1], clsid.Data4[2], clsid.Data4[3], clsid.Data4[4], clsid.Data4[5], clsid.Data4[6], clsid.Data4[7] );
        OutputDebugString(szTemp);
        DebugBreak();              
    }                              
    #endif AUDANALYZE_NODEBUG
    return hr;                     
}
